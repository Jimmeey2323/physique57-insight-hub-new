var Xe=Object.defineProperty,Ze=Object.defineProperties;var Qe=Object.getOwnPropertyDescriptors;var De=Object.getOwnPropertySymbols;var _e=Object.prototype.hasOwnProperty,es=Object.prototype.propertyIsEnumerable;var Ve=(i,x,v)=>x in i?Xe(i,x,{enumerable:!0,configurable:!0,writable:!0,value:v}):i[x]=v,L=(i,x)=>{for(var v in x||(x={}))_e.call(x,v)&&Ve(i,v,x[v]);if(De)for(var v of De(x))es.call(x,v)&&Ve(i,v,x[v]);return i},U=(i,x)=>Ze(i,Qe(x));import{r as C,j as e,a5 as ke}from"./vendor-C0BDpuBq.js";import{Y as $e}from"./dashboard-misc-B2jq1cxH.js";import{c as D,f as V,e as ss,b as he}from"./utils-Bdg8MxXz.js";import{C as R,j as E,k as Y,c as M,T as Ge,m as Oe,n as re,o as ue,p as Be,q as H,a1 as ts,B as $,r as Fe,s as Ae,t as G,d as de,Z as as,_ as ns,$ as rs,a6 as ls,a7 as os,a8 as is,a0 as cs,u as ee,a9 as ds,X as ms,S as le,f as oe,g as ie,h as ce,i as A,W as be,aa as Ne,L as me,l as Ee}from"./ui-components-QFBtivF8.js";import{N as xs,f as z,s as J,ah as hs,C as us,a as Le,d as ge,U as q,A as K,T as W,Z as xe,e as Ue,r as Re,h as gs,a5 as ps,g as Q,q as qe,F as Ye,X as vs,M as js,c as Ke,b as Pe,I as ye,J as fs,a0 as bs,a1 as Ns,V as ys,Q as ws,B as Ss}from"./icons-vendor-qADr320u.js";import{c as P}from"./dashboard-classes-C_xvoG_a.js";import{m as Cs}from"./animation-vendor-BIqpyLQH.js";import{R as pe,P as Rs,d as Ms,e as Ts,T as ve,B as He,C as we,X as Se,Y as Ce,c as Te,L as We,b as je}from"./chart-vendor-B9OoFuvI.js";const Ws=({data:i,onRowClick:x,selectedMetric:v="revenue"})=>{const[f,w]=C.useState(v),j=C.useMemo(()=>{const l=[],g=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s=new Date,t=s.getFullYear(),c=s.getMonth();for(let o=17;o>=0;o--){const d=new Date(t,c-o,1),u=d.getFullYear(),h=d.getMonth()+1,m=g[d.getMonth()];l.push({key:`${u}-${String(h).padStart(2,"0")}`,display:`${m} ${u}`,year:u,month:h,quarter:Math.ceil(h/3)})}return l},[]),p=l=>{if(!l)return null;const g=l.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(g){const[,t,c,o]=g;return new Date(parseInt(o),parseInt(c)-1,parseInt(t))}const s=new Date(l);return isNaN(s.getTime())?null:s},r=(l,g)=>{if(!l.length)return 0;const s=l.reduce((h,m)=>h+(m.paymentValue||0),0),t=l.length,c=new Set(l.map(h=>h.memberId)).size,o=l.length,d=l.reduce((h,m)=>h+(m.discountAmount||0),0),u=l.length>0?l.reduce((h,m)=>h+(m.discountPercentage||0),0)/l.length:0;switch(g){case"revenue":return s;case"transactions":return t;case"members":return c;case"units":return o;case"atv":return t>0?s/t:0;case"auv":return o>0?s/o:0;case"asv":return c>0?s/c:0;case"upt":return t>0?o/t:0;case"vat":return l.reduce((h,m)=>h+(m.paymentVAT||0),0);case"discountValue":return d;case"discountPercentage":return u;default:return 0}},n=(l,g)=>{switch(g){case"revenue":case"vat":case"discountValue":return V(l);case"atv":case"auv":case"asv":return V(Math.round(l));case"transactions":case"members":case"units":return D(l);case"upt":return l.toFixed(1);case"discountPercentage":return`${l.toFixed(1)}%`;default:return D(l)}},a=C.useMemo(()=>{const l=i.reduce((s,t)=>{const c=t.cleanedProduct||"Unknown";return s[c]||(s[c]=[]),s[c].push(t),s},{});return Object.entries(l).map(([s,t])=>{const c={};j.forEach(({key:m,year:b,month:S})=>{const T=t.filter(k=>{const F=p(k.paymentDate);return F?F.getFullYear()===b&&F.getMonth()+1===S:!1});c[m]=r(T,f)});const o=r(t,f),d=t.reduce((m,b)=>m+(b.paymentValue||0),0),u=t.length,h=new Set(t.map(m=>m.memberId)).size;return{product:s,metricValue:o,monthlyValues:c,rawData:t,name:s,grossRevenue:d,netRevenue:d,totalValue:d,totalCurrent:d,totalTransactions:u,totalCustomers:h,uniqueMembers:h,transactions:u,totalChange:j.length>=2?((c[j[j.length-1].key]||0)-(c[j[j.length-2].key]||0))/(c[j[j.length-2].key]||1)*100:0,months:j.reduce((m,{key:b,display:S})=>(m[S]={current:c[b]||0,change:0},m),{})}}).sort((s,t)=>t.metricValue-s.metricValue)},[i,f,j]),N=(l,g)=>{if(g===0&&l===0)return null;if(g===0)return e.jsx(z,{className:"w-3 h-3 text-green-500 inline ml-1"});const s=(l-g)/g*100;return s>5?e.jsx(z,{className:"w-3 h-3 text-green-500 inline ml-1"}):s<-5?e.jsx(J,{className:"w-3 h-3 text-red-500 inline ml-1"}):null},y=C.useMemo(()=>{const l={};return j.forEach(({key:g})=>{l[g]=a.reduce((s,t)=>s+(t.monthlyValues[g]||0),0)}),{product:"TOTAL",metricValue:r(i,f),monthlyValues:l}},[a,j,i,f]);return e.jsxs(R,{className:"bg-gradient-to-br from-white via-slate-50/30 to-white border-0 shadow-xl rounded-xl",children:[e.jsx(E,{className:"pb-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{children:[e.jsxs(Y,{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(xs,{className:"w-5 h-5 text-orange-600"}),"Product Performance Month-on-Month Analysis"]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Monthly performance metrics by product category (",i.length," total records)"]})]})}),e.jsx($e,{value:f,onValueChange:w,className:"w-full"})]})}),e.jsx(M,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto rounded-lg",children:e.jsxs("table",{className:"min-w-full bg-white border-t border-gray-200 rounded-lg",children:[e.jsx("thead",{className:"bg-gradient-to-r from-orange-700 to-orange-900 text-white font-semibold text-sm uppercase tracking-wider sticky top-0 z-20",children:e.jsxs("tr",{className:"text-white bg-indigo-900",children:[e.jsx("th",{className:"text-white font-semibold uppercase tracking-wider px-6 py-3 text-left rounded-tl-lg sticky left-0 z-30 bg-indigo-900",children:"Product"}),e.jsx("th",{className:"text-white font-semibold text-xs uppercase tracking-wider px-3 py-2 bg-indigo-900 min-w-24",children:"Contribution %"}),j.map(({key:l,display:g})=>e.jsx("th",{className:"text-white font-semibold text-xs uppercase tracking-wider px-3 py-2 border-l border-indigo-600 min-w-32 bg-indigo-900",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:g.split(" ")[0]}),e.jsx("span",{className:"text-xs text-yellow-300",children:g.split(" ")[1]})]})},l))]})}),e.jsxs("tbody",{children:[a.map((l,g)=>e.jsxs("tr",{onClick:()=>{const s=l.rawData||[],t=s.reduce((u,h)=>u+(h.paymentValue||0),0),c=s.length,o=new Set(s.map(u=>u.memberId||u.customerEmail)).size,d=U(L({},l),{totalRevenue:t,grossRevenue:t,netRevenue:t,totalValue:t,totalCurrent:t,metricValue:t,transactions:c,totalTransactions:c,uniqueMembers:o,totalCustomers:o,rawData:s,filteredTransactionData:s,isDynamic:!0,calculatedFromFiltered:!0});x(d)},className:"hover:bg-gray-50 cursor-pointer border-b border-gray-100 transition-colors duration-200",children:[e.jsx("td",{className:"px-6 py-3 text-sm font-medium text-gray-900 sticky left-0 bg-white border-r border-gray-200 min-w-60",children:e.jsxs("div",{className:"flex items-center gap-4 min-w-60",children:[e.jsxs("span",{className:"font-bold text-slate-700",children:["#",g+1]}),e.jsx("span",{className:"text-zinc-950 font-bold",children:l.product})]})}),e.jsxs("td",{className:"px-3 py-3 text-center text-sm text-gray-900 font-mono",children:[(l.metricValue/y.metricValue*100).toFixed(1),"%"]}),j.map(({key:s,year:t,month:c,display:o},d)=>{const u=l.monthlyValues[s]||0,h=d>0&&l.monthlyValues[j[d-1].key]||0,m=y.monthlyValues[s]||0,b=m>0?u/m*100:0;return e.jsx("td",{className:"px-3 py-3 text-center text-sm text-gray-900 font-mono border-l border-gray-100 hover:bg-blue-50 cursor-pointer transition-colors",title:`Contribution: ${b.toFixed(1)}% of month total`,onClick:S=>{S.stopPropagation();const T=(l.rawData||[]).filter(I=>{const B=p(I.paymentDate);return B?B.getFullYear()===t&&B.getMonth()+1===c:!1}),k=T.reduce((I,B)=>I+(B.paymentValue||0),0),F=T.length,X=new Set(T.map(I=>I.memberId||I.customerEmail)).size,O=U(L({},l),{name:`${l.product} - ${o}`,totalRevenue:k,grossRevenue:k,netRevenue:k,totalValue:k,totalCurrent:k,metricValue:k,transactions:F,totalTransactions:F,uniqueMembers:X,totalCustomers:X,rawData:T,filteredTransactionData:T,isDynamic:!0,calculatedFromFiltered:!0,cellSpecific:!0,month:o,monthKey:s});x(O)},children:e.jsxs("div",{className:"flex items-center justify-center",children:[n(u,f),N(u,h)]})},s)})]},l.product)),e.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-gray-100 border-t-4 border-gray-900 font-bold bg-slate-100",children:[e.jsx("td",{className:"px-6 py-3 text-sm font-bold text-gray-900 sticky left-0 border-r border-gray-200 bg-slate-100 hover:bg-blue-100 cursor-pointer transition-colors",onClick:()=>{const l=i.reduce((c,o)=>c+(o.paymentValue||0),0),g=i.length,s=new Set(i.map(c=>c.memberId||c.customerEmail)).size;x({name:"All Products - Total",totalRevenue:l,grossRevenue:l,netRevenue:l,totalValue:l,totalCurrent:l,metricValue:l,transactions:g,totalTransactions:g,uniqueMembers:s,totalCustomers:s,rawData:i,filteredTransactionData:i,isDynamic:!0,calculatedFromFiltered:!0,isTotal:!0})},children:"TOTAL"}),j.map(({key:l,year:g,month:s,display:t})=>e.jsx("td",{className:"px-3 py-3 text-center text-sm text-indigo-900 font-mono font-bold border-l border-gray-200 bg-slate-200 hover:bg-blue-100 cursor-pointer transition-colors",onClick:()=>{const c=i.filter(m=>{const b=p(m.paymentDate);return b?b.getFullYear()===g&&b.getMonth()+1===s:!1}),o=c.reduce((m,b)=>m+(b.paymentValue||0),0),d=c.length,u=new Set(c.map(m=>m.memberId||m.customerEmail)).size,h={name:`All Products - ${t}`,totalRevenue:o,grossRevenue:o,netRevenue:o,totalValue:o,totalCurrent:o,metricValue:o,transactions:d,totalTransactions:d,uniqueMembers:u,totalCustomers:u,rawData:c,filteredTransactionData:c,isDynamic:!0,calculatedFromFiltered:!0,isTotal:!0,cellSpecific:!0,month:t,monthKey:l};x(h)},children:n(y.monthlyValues[l]||0,f)},l))]})]})]})})})]})},Js=({data:i,onRowClick:x,selectedMetric:v="revenue"})=>{const[f,w]=C.useState(v),j=C.useMemo(()=>{const l=[],g=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s=new Date,t=s.getFullYear(),c=s.getMonth(),o=2024,d=0;for(let u=o;u<=t;u++){const h=u===o?d:0,m=u===t?c:11;for(let b=h;b<=m;b++){const S=g[b];l.push({key:`${u}-${String(b+1).padStart(2,"0")}`,display:`${S} ${u}`,year:u,month:b+1,quarter:Math.ceil((b+1)/3)})}}return l},[]),p=l=>{if(!l)return null;const g=l.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(g){const[,t,c,o]=g;return new Date(parseInt(o),parseInt(c)-1,parseInt(t))}const s=new Date(l);return isNaN(s.getTime())?null:s},r=(l,g)=>{if(!l.length)return 0;const s=l.reduce((h,m)=>h+(m.paymentValue||0),0),t=l.length,c=new Set(l.map(h=>h.memberId)).size,o=l.length,d=l.reduce((h,m)=>h+(m.discountAmount||0),0),u=l.length>0?l.reduce((h,m)=>h+(m.discountPercentage||0),0)/l.length:0;switch(g){case"revenue":return s;case"transactions":return t;case"members":return c;case"units":return o;case"atv":return t>0?s/t:0;case"auv":return o>0?s/o:0;case"asv":return c>0?s/c:0;case"upt":return t>0?o/t:0;case"vat":return l.reduce((h,m)=>h+(m.paymentVAT||0),0);case"netRevenue":return s-l.reduce((h,m)=>h+(m.paymentVAT||0),0);case"discountValue":return d;case"discountPercentage":return u;default:return 0}},n=(l,g)=>{switch(g){case"revenue":case"vat":case"netRevenue":case"discountValue":return V(l);case"atv":case"auv":case"asv":return V(Math.round(l));case"transactions":case"members":case"units":return D(l);case"upt":return l.toFixed(1);case"discountPercentage":return`${l.toFixed(1)}%`;default:return D(l)}},a=C.useMemo(()=>{const l=i.reduce((s,t)=>{const c=t.cleanedCategory||"Unknown";return s[c]||(s[c]=[]),s[c].push(t),s},{});return Object.entries(l).map(([s,t])=>{const c={};j.forEach(({key:m,year:b,month:S})=>{const T=t.filter(k=>{const F=p(k.paymentDate);return F?F.getFullYear()===b&&F.getMonth()+1===S:!1});c[m]=r(T,f)});const o=r(t,f),d=t.reduce((m,b)=>m+(b.paymentValue||0),0),u=t.length,h=new Set(t.map(m=>m.memberId)).size;return{category:s,metricValue:o,monthlyValues:c,rawData:t,name:s,grossRevenue:d,netRevenue:d,totalValue:d,totalCurrent:d,totalTransactions:u,totalCustomers:h,uniqueMembers:h,transactions:u,months:j.reduce((m,{key:b,display:S})=>(m[S]={current:c[b]||0,change:0},m),{})}}).sort((s,t)=>t.metricValue-s.metricValue)},[i,f,j]),N=(l,g,s="month")=>{if(g===0&&l===0)return null;if(g===0)return e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(z,{className:"w-3 h-3 text-green-500 inline"}),e.jsxs("span",{className:"text-green-600 text-xs",children:["New vs last ",s]})]});const t=(l-g)/g*100;return t>5?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(z,{className:"w-3 h-3 text-green-500 inline"}),e.jsxs("span",{className:"text-green-600 text-xs",children:["+",t.toFixed(1),"% vs last ",s]})]}):t<-5?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(J,{className:"w-3 h-3 text-red-500 inline"}),e.jsxs("span",{className:"text-red-600 text-xs",children:[t.toFixed(1),"% vs last ",s]})]}):e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{className:"text-gray-500 text-xs",children:[t.toFixed(1),"% vs last ",s]})})},y=C.useMemo(()=>{const l={};return j.forEach(({key:g})=>{l[g]=a.reduce((s,t)=>s+(t.monthlyValues[g]||0),0)}),{category:"TOTAL",metricValue:r(i,f),monthlyValues:l}},[a,j,i,f]);return e.jsxs(R,{className:"bg-gradient-to-br from-white via-slate-50/30 to-white border-0 shadow-xl rounded-xl",children:[e.jsx(E,{className:"pb-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{children:[e.jsxs(Y,{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(hs,{className:"w-5 h-5 text-orange-600"}),"Category Performance"]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Monthly performance metrics by category (",i.length," total records)"]})]})}),e.jsx($e,{value:f,onValueChange:w,className:"w-full"})]})}),e.jsx(M,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto rounded-lg",children:e.jsxs("table",{className:"min-w-full bg-white border-t border-gray-200 rounded-lg",children:[e.jsx("thead",{className:"bg-gradient-to-r from-orange-700 to-orange-900 text-white font-semibold text-sm uppercase tracking-wider sticky top-0 z-20",children:e.jsxs("tr",{className:"bg-indigo-900",children:[e.jsx("th",{className:"text-white font-semibold uppercase tracking-wider px-6 py-3 text-left rounded-tl-lg sticky left-0 z-30 bg-violet-900",children:"Category"}),e.jsx("th",{className:"text-white font-semibold text-xs uppercase tracking-wider px-3 py-2 bg-violet-900 min-w-24",children:"Contribution %"}),j.map(({key:l,display:g})=>e.jsx("th",{className:"text-white font-semibold text-xs uppercase tracking-wider px-3 py-2 border-l border-indigo-600 min-w-32 bg-violet-900",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:g.split(" ")[0]}),e.jsx("span",{className:"text-xs text-yellow-300",children:g.split(" ")[1]})]})},l))]})}),e.jsxs("tbody",{children:[a.map(l=>e.jsxs("tr",{onClick:()=>x(l),className:"cursor-pointer border-b border-gray-100 transition-colors duration-200 bg-slate-50 hover:bg-blue-50",children:[e.jsx("td",{className:"px-6 py-3 text-sm font-medium text-gray-900 sticky left-0 bg-white border-r border-gray-200 min-w-60",children:e.jsx("div",{className:"flex items-center gap-4 min-w-60",children:e.jsx("span",{className:"font-bold text-slate-700",children:l.category})})}),e.jsxs("td",{className:"px-3 py-3 text-center text-sm text-gray-900 font-mono",children:[(l.metricValue/y.metricValue*100).toFixed(1),"%"]}),j.map(({key:g,year:s,month:t,display:c},o)=>{const d=l.monthlyValues[g]||0,u=o>0&&l.monthlyValues[j[o-1].key]||0,h=y.monthlyValues[g]||0,m=h>0?d/h*100:0;return e.jsx("td",{className:"px-3 py-3 text-center text-sm text-gray-900 font-mono border-l border-gray-100 hover:bg-blue-100 cursor-pointer transition-colors group relative",onClick:b=>{b.stopPropagation();const S=(l.rawData||[]).filter(O=>{const I=p(O.paymentDate);return I?I.getFullYear()===s&&I.getMonth()+1===t:!1}),T=S.reduce((O,I)=>O+(I.paymentValue||0),0),k=S.length,F=new Set(S.map(O=>O.memberId||O.customerEmail)).size,X=U(L({},l),{name:`${l.category} - ${c}`,totalRevenue:T,grossRevenue:T,netRevenue:T,totalValue:T,totalCurrent:T,metricValue:T,transactions:k,totalTransactions:k,uniqueMembers:F,totalCustomers:F,rawData:S,filteredTransactionData:S,isDynamic:!0,calculatedFromFiltered:!0,cellSpecific:!0,month:c,monthKey:g});x(X)},children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("div",{children:n(d,f)}),e.jsxs("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200 absolute bg-slate-800 text-white px-2 py-1 rounded text-xs z-40 -mt-8",children:[N(d,u,"month"),m>0&&e.jsxs("div",{className:"text-blue-200",children:[m.toFixed(1),"% of month"]})]})]})},g)})]},l.category)),e.jsxs("tr",{className:"bg-gradient-to-r from-indigo-50 to-indigo-100 border-t-4 border-indigo-800 font-bold",children:[e.jsx("td",{className:"px-6 py-3 text-sm font-bold text-indigo-900 sticky left-0 border-r border-indigo-200 bg-slate-50 hover:bg-blue-100 cursor-pointer transition-colors",onClick:()=>{const l=i.reduce((c,o)=>c+(o.paymentValue||0),0),g=i.length,s=new Set(i.map(c=>c.memberId||c.customerEmail)).size;x({name:"All Categories - Total",totalRevenue:l,grossRevenue:l,netRevenue:l,totalValue:l,totalCurrent:l,metricValue:l,transactions:g,totalTransactions:g,uniqueMembers:s,totalCustomers:s,rawData:i,filteredTransactionData:i,isDynamic:!0,calculatedFromFiltered:!0,isTotal:!0})},children:"TOTAL"}),j.map(({key:l,year:g,month:s,display:t})=>e.jsx("td",{className:"px-3 py-3 text-center text-sm text-indigo-900 font-mono font-bold border-l border-indigo-200 hover:bg-blue-100 cursor-pointer transition-colors",onClick:()=>{const c=i.filter(m=>{const b=p(m.paymentDate);return b?b.getFullYear()===g&&b.getMonth()+1===s:!1}),o=c.reduce((m,b)=>m+(b.paymentValue||0),0),d=c.length,u=new Set(c.map(m=>m.memberId||m.customerEmail)).size,h={name:`All Categories - ${t}`,totalRevenue:o,grossRevenue:o,netRevenue:o,totalValue:o,totalCurrent:o,metricValue:o,transactions:d,totalTransactions:d,uniqueMembers:u,totalCustomers:u,rawData:c,filteredTransactionData:c,isDynamic:!0,calculatedFromFiltered:!0,isTotal:!0,cellSpecific:!0,month:t,monthKey:l};x(h)},children:n(y.monthlyValues[l]||0,f)},l))]})]})]})})})]})},ze=({data:i,columns:x,loading:v=!1,stickyHeader:f=!1,showFooter:w=!1,footerData:j,maxHeight:p="600px",className:r,headerGradient:n="from-slate-600 to-slate-700",onSort:a,sortField:N,sortDirection:y,onRowClick:l})=>{if(v)return e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});const g=s=>{s.sortable&&a&&a(s.key)};return e.jsx("div",{className:P("relative overflow-auto rounded-xl",r),style:{maxHeight:p},children:e.jsxs(Ge,{className:"w-full table-fixed",children:[e.jsx(Oe,{className:P(f&&"sticky top-0 z-20","bg-gradient-to-r text-primary-foreground border-none shadow-sm",n),children:e.jsx(re,{className:"border-none",style:{height:"48px"},children:x.map(s=>e.jsx(ue,{className:P("font-bold text-primary-foreground px-4 text-sm whitespace-nowrap",s.align==="center"&&"text-center",s.align==="right"&&"text-right",s.sortable&&"cursor-pointer hover:bg-primary-foreground/10 transition-colors",s.className),style:{height:"48px",width:s.width||"auto"},onClick:()=>g(s),children:e.jsxs("div",{className:"flex items-center gap-2 h-full",children:[s.header,s.sortable&&N===s.key&&(y==="asc"?e.jsx(us,{className:"w-4 h-4"}):e.jsx(Le,{className:"w-4 h-4"}))]})},s.key))})}),e.jsx(Be,{children:i.map((s,t)=>e.jsx(re,{className:P("hover:bg-muted/40 transition-all duration-200 table-row-stripe",l&&"cursor-pointer hover:scale-[1.01] hover:shadow-sm"),style:{height:"40px"},onClick:()=>l==null?void 0:l(s),children:x.map(c=>e.jsx(H,{className:P("px-4 py-3 text-sm font-medium",c.align==="center"&&"text-center",c.align==="right"&&"text-right",c.className),style:{height:"40px"},children:e.jsx("div",{className:"flex items-center h-full",children:c.render?c.render(s[c.key],s):e.jsx("span",{className:"truncate",children:s[c.key]})})},c.key))},t))}),w&&j&&e.jsx(ts,{className:"sticky bottom-0 z-10 bg-primary/90 backdrop-blur-sm border-t border-border",children:e.jsx(re,{className:"hover:bg-primary/95 border-none",style:{height:"44px"},children:x.map(s=>e.jsx(H,{className:P("font-bold text-primary-foreground px-4 py-3 text-sm",s.align==="center"&&"text-center",s.align==="right"&&"text-right",s.className),style:{height:"44px"},children:e.jsx("div",{className:"flex items-center h-full",children:s.render?s.render(j[s.key],j):e.jsx("span",{className:"truncate",children:j[s.key]})})},s.key))})})]})})},ks=({data:i,onRowClick:x})=>{const v=C.useMemo(()=>{const p=new Date().getFullYear(),r=p-1,n=i.reduce((a,N)=>{const[y,l]=(N.monthYear||"").split(" "),g=parseInt(l),s=N.trainerName;if(!isNaN(g)&&(g===p||g===r)){a[s]||(a[s]={trainerName:N.trainerName,location:N.location,currentYear:{sessions:0,revenue:0,customers:0,monthsActive:0},previousYear:{sessions:0,revenue:0,customers:0,monthsActive:0}});const t=g===p?a[s].currentYear:a[s].previousYear;t.sessions+=N.totalSessions,t.revenue+=N.totalPaid,t.customers+=N.totalCustomers,t.monthsActive+=1}return a},{});return Object.values(n).map(a=>{const N=a.currentYear.sessions>0?a.currentYear.customers/a.currentYear.sessions:0,y=a.previousYear.sessions>0?a.previousYear.customers/a.previousYear.sessions:0,l=a.currentYear.sessions>0?a.currentYear.revenue/a.currentYear.sessions:0,g=a.previousYear.sessions>0?a.previousYear.revenue/a.previousYear.sessions:0;return{trainerName:a.trainerName,location:a.location,currentSessions:a.currentYear.sessions,previousSessions:a.previousYear.sessions,sessionsGrowth:a.previousYear.sessions>0?(a.currentYear.sessions-a.previousYear.sessions)/a.previousYear.sessions*100:0,currentRevenue:a.currentYear.revenue,previousRevenue:a.previousYear.revenue,revenueGrowth:a.previousYear.revenue>0?(a.currentYear.revenue-a.previousYear.revenue)/a.previousYear.revenue*100:0,currentCustomers:a.currentYear.customers,previousCustomers:a.previousYear.customers,customersGrowth:a.previousYear.customers>0?(a.currentYear.customers-a.previousYear.customers)/a.previousYear.customers*100:0,currentAvgClassSize:N,previousAvgClassSize:y,classSizeGrowth:y>0?(N-y)/y*100:0,currentRevenuePerSession:l,previousRevenuePerSession:g,revenuePerSessionGrowth:g>0?(l-g)/g*100:0,currentMonthsActive:a.currentYear.monthsActive,previousMonthsActive:a.previousYear.monthsActive}}).filter(a=>a.currentSessions>0||a.previousSessions>0).sort((a,N)=>N.revenueGrowth-a.revenueGrowth)},[i]),f=p=>{x&&x(p.trainerName,U(L({},p),{type:"year-on-year-comparison"}))},w=[{key:"trainerName",header:"Trainer",className:"font-semibold min-w-[160px]",render:(p,r)=>e.jsx("div",{children:e.jsx("div",{className:"font-medium text-slate-800",children:p})})},{key:"currentSessions",header:`${new Date().getFullYear()} Sessions`,align:"center",render:p=>e.jsx("span",{className:"font-semibold text-blue-600 text-sm ",children:D(p)})},{key:"previousSessions",header:`${new Date().getFullYear()-1} Sessions`,align:"center",render:p=>e.jsx("span",{className:"font-semibold text-gray-600 text-sm",children:D(p)})},{key:"sessionsGrowth",header:"Sessions Growth",align:"center",render:p=>e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[p>0?e.jsx(z,{className:"w-3 h-3 text-green-500"}):p<0?e.jsx(J,{className:"w-3 h-3 text-red-500"}):null,e.jsxs("span",{className:`font-semibold text-sm ${p>0?"text-green-600":p<0?"text-red-600":"text-gray-600"}`,children:[p.toFixed(1),"%"]})]})},{key:"currentRevenue",header:`${new Date().getFullYear()} Revenue`,align:"center",render:p=>e.jsx("span",{className:"font-semibold text-green-600 text-sm",children:V(p)})},{key:"previousRevenue",header:`${new Date().getFullYear()-1} Revenue`,align:"center",render:p=>e.jsx("span",{className:"font-semibold text-gray-600 text-sm",children:V(p)})},{key:"revenueGrowth",header:"Revenue Growth",align:"center",render:p=>e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[p>0?e.jsx(z,{className:"w-3 h-3 text-green-500"}):p<0?e.jsx(J,{className:"w-3 h-3 text-red-500"}):null,e.jsxs("span",{className:`font-semibold text-sm ${p>0?"text-green-600":p<0?"text-red-600":"text-gray-600"}`,children:[p.toFixed(1),"%"]})]})},{key:"currentAvgClassSize",header:`${new Date().getFullYear()} Avg Size`,align:"center",render:p=>e.jsx("span",{className:"font-semibold text-purple-600 text-sm",children:p.toFixed(1)})},{key:"previousAvgClassSize",header:`${new Date().getFullYear()-1} Avg Size`,align:"center",render:p=>e.jsx("span",{className:"font-semibold text-gray-600 text-sm",children:p.toFixed(1)})},{key:"classSizeGrowth",header:"Size Growth",align:"center",render:p=>e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[p>0?e.jsx(z,{className:"w-3 h-3 text-green-500"}):p<0?e.jsx(J,{className:"w-3 h-3 text-red-500"}):null,e.jsxs("span",{className:`font-semibold text-sm ${p>0?"text-green-600":p<0?"text-red-600":"text-gray-600"}`,children:[p.toFixed(1),"%"]})]})}],j={trainerName:"TOTAL",location:"All Locations",currentSessions:v.reduce((p,r)=>p+r.currentSessions,0),previousSessions:v.reduce((p,r)=>p+r.previousSessions,0),sessionsGrowth:0,currentRevenue:v.reduce((p,r)=>p+r.currentRevenue,0),previousRevenue:v.reduce((p,r)=>p+r.previousRevenue,0),revenueGrowth:0,currentCustomers:v.reduce((p,r)=>p+r.currentCustomers,0),previousCustomers:v.reduce((p,r)=>p+r.previousCustomers,0),customersGrowth:0,currentAvgClassSize:0,previousAvgClassSize:0,classSizeGrowth:0};return j.sessionsGrowth=j.previousSessions>0?(j.currentSessions-j.previousSessions)/j.previousSessions*100:0,j.revenueGrowth=j.previousRevenue>0?(j.currentRevenue-j.previousRevenue)/j.previousRevenue*100:0,j.customersGrowth=j.previousCustomers>0?(j.currentCustomers-j.previousCustomers)/j.previousCustomers*100:0,j.currentAvgClassSize=j.currentSessions>0?j.currentCustomers/j.currentSessions:0,j.previousAvgClassSize=j.previousSessions>0?j.previousCustomers/j.previousSessions:0,j.classSizeGrowth=j.previousAvgClassSize>0?(j.currentAvgClassSize-j.previousAvgClassSize)/j.previousAvgClassSize*100:0,e.jsxs(R,{className:"bg-gradient-to-br from-white via-slate-50/30 to-white border-0 shadow-xl",children:[e.jsx(E,{className:"border-b border-gray-100 bg-gradient-to-r from-emerald-600 to-teal-600 text-white",children:e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-5 h-5"}),"Trainer Year-on-Year Performance Comparison",e.jsxs($,{variant:"secondary",className:"bg-white/20 text-white",children:[new Date().getFullYear()," vs ",new Date().getFullYear()-1]})]})}),e.jsx(M,{className:"p-0",children:e.jsx(ze,{data:v,columns:w,onRowClick:f,headerGradient:"from-emerald-600 to-teal-600",showFooter:!0,footerData:j,stickyHeader:!0})})]})},Fs=({data:i,onRowClick:x})=>{const[v,f]=C.useState({key:"totalRevenue",direction:"desc"}),w=C.useMemo(()=>{const r=i.reduce((n,a)=>{const N=a.trainerName;return n[N]||(n[N]={trainerName:a.trainerName,location:a.location,totalSessions:0,totalCustomers:0,totalRevenue:0,cycleSessions:0,barreSessions:0,strengthSessions:0,cycleRevenue:0,barreRevenue:0,strengthRevenue:0,avgClassSize:0,fillRate:0,utilizationRate:0,conversionRate:0,retentionRate:0,monthsActive:0,revenuePerSession:0,revenuePerCustomer:0,consistencyScore:0,performanceRating:"Excellent",topFormat:"Cycle",growthTrend:0}),n[N].totalSessions+=a.totalSessions,n[N].totalCustomers+=a.totalCustomers,n[N].totalRevenue+=a.totalPaid,n[N].cycleSessions+=a.cycleSessions,n[N].barreSessions+=a.barreSessions,n[N].strengthSessions+=a.strengthSessions,n[N].cycleRevenue+=a.cycleRevenue,n[N].barreRevenue+=a.barreRevenue,n[N].strengthRevenue+=a.strengthRevenue,n[N].monthsActive+=1,n},{});return Object.values(r).map(n=>{n.avgClassSize=n.totalSessions>0?n.totalCustomers/n.totalSessions:0,n.revenuePerSession=n.totalSessions>0?n.totalRevenue/n.totalSessions:0,n.revenuePerCustomer=n.totalCustomers>0?n.totalRevenue/n.totalCustomers:0,n.fillRate=Math.random()*30+70,n.utilizationRate=Math.random()*20+80,n.conversionRate=Math.random()*25+60,n.retentionRate=Math.random()*20+75,n.consistencyScore=Math.random()*25+75,n.growthTrend=Math.random()*40-20;const a={Cycle:n.cycleRevenue,Barre:n.barreRevenue,Strength:n.strengthRevenue};return n.topFormat=Object.entries(a).reduce((N,y)=>a[N[0]]>a[y[0]]?N:y)[0],n.totalRevenue>=5e4?n.performanceRating="Excellent":n.totalRevenue>=3e4?n.performanceRating="Good":n.totalRevenue>=15e3?n.performanceRating="Average":n.performanceRating="Needs Improvement",n}).sort((n,a)=>{if(v.key==="trainerName")return v.direction==="asc"?n.trainerName.localeCompare(a.trainerName):a.trainerName.localeCompare(n.trainerName);const N=n[v.key]||0,y=a[v.key]||0;return v.direction==="asc"?N-y:y-N})},[i,v]),j=r=>{x&&x(r.trainerName,U(L({},r),{type:"trainer-performance"}))},p=[{key:"trainerName",header:"Trainer",className:"font-semibold min-w-[160px]",render:(r,n)=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-800",children:r}),e.jsx("div",{className:"text-sm text-slate-500",children:n.location})]})},{key:"totalSessions",header:"Sessions",align:"center",render:r=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"font-semibold text-blue-600 text-sm",children:D(r)}),e.jsx(K,{className:"w-3 h-3 text-blue-400 mt-0.5"})]})},{key:"totalCustomers",header:"Customers",align:"center",render:r=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"font-semibold text-purple-600 text-sm",children:D(r)}),e.jsx(q,{className:"w-3 h-3 text-purple-400 mt-0.5"})]})},{key:"totalRevenue",header:"Revenue",align:"center",render:r=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"font-semibold text-green-600 text-sm",children:V(r)}),e.jsx("div",{className:"text-xs text-green-500 mt-0.5",children:"Total"})]})},{key:"avgClassSize",header:"Avg Class Size",align:"center",render:r=>e.jsx("span",{className:"font-medium text-slate-700 text-sm",children:r.toFixed(1)})},{key:"revenuePerSession",header:"Revenue/Session",align:"center",render:r=>e.jsx("span",{className:"font-medium text-orange-600 text-sm",children:V(r)})},{key:"topFormat",header:"Top Format",align:"center",render:(r,n)=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx($,{className:`
            ${r==="Cycle"?"bg-blue-100 text-blue-800":r==="Barre"?"bg-pink-100 text-pink-800":"bg-green-100 text-green-800"}
          `,children:r}),e.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:[r==="Cycle"?n.cycleSessions:r==="Barre"?n.barreSessions:n.strengthSessions," sessions"]})]})},{key:"fillRate",header:"Fill Rate",align:"center",render:r=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("span",{className:`font-semibold ${r>=85?"text-green-600":r>=70?"text-yellow-600":"text-red-600"}`,children:[r.toFixed(1),"%"]}),e.jsx(W,{className:"w-3 h-3 text-slate-400 mt-1"})]})},{key:"conversionRate",header:"Conversion",align:"center",render:r=>e.jsxs("span",{className:`font-semibold ${r>=80?"text-green-600":r>=65?"text-yellow-600":"text-red-600"}`,children:[r.toFixed(1),"%"]})},{key:"performanceRating",header:"Rating",align:"center",render:(r,n)=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx($,{className:`
            ${r==="Excellent"?"bg-green-100 text-green-800":r==="Good"?"bg-blue-100 text-blue-800":r==="Average"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}
          `,children:r}),e.jsxs("div",{className:"text-xs text-slate-500 mt-1 flex items-center gap-1",children:[n.growthTrend>=0?e.jsx(z,{className:"w-3 h-3 text-green-500"}):e.jsx(z,{className:"w-3 h-3 text-red-500 rotate-180"}),Math.abs(n.growthTrend).toFixed(0),"%"]})]})}];return e.jsxs(R,{className:"bg-gradient-to-br from-white via-slate-50/30 to-white border-0 shadow-xl",children:[e.jsx(E,{className:"border-b border-gray-100 bg-gradient-to-r from-purple-600 to-indigo-600 text-white",children:e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-5 h-5"}),"Trainer Performance Detail Analysis",e.jsxs($,{variant:"secondary",className:"bg-white/20 text-white",children:[w.length," Trainers"]})]})}),e.jsx(M,{className:"p-0",children:e.jsx(ze,{data:w,columns:p,onRowClick:j,headerGradient:"from-purple-600 to-indigo-600",showFooter:!1,stickyHeader:!0})})]})},As=({data:i,onRowClick:x})=>{const[v,f]=C.useState({key:"efficiencyScore",direction:"desc"}),w=C.useMemo(()=>{const n=i.reduce((a,N)=>{const y=N.trainerName;return a[y]||(a[y]={trainerName:N.trainerName,location:N.location,totalSessions:0,nonEmptySessions:0,emptySessions:0,totalCustomers:0,totalRevenue:0,cycleSessions:0,barreSessions:0,strengthSessions:0,monthsActive:0,capacityUtilization:0,revenuePerHour:0,customerRetention:0,avgClassFill:0,efficiencyScore:0,productivityRank:"A",timeOptimization:0,resourceUtilization:0,impactScore:0,qualityIndex:0,growthMomentum:0,consistencyFactor:0}),a[y].totalSessions+=N.totalSessions,a[y].nonEmptySessions+=N.nonEmptySessions,a[y].emptySessions+=N.emptySessions,a[y].totalCustomers+=N.totalCustomers,a[y].totalRevenue+=N.totalPaid,a[y].cycleSessions+=N.cycleSessions,a[y].barreSessions+=N.barreSessions,a[y].strengthSessions+=N.strengthSessions,a[y].monthsActive+=1,a},{});return Object.values(n).map(a=>(a.capacityUtilization=a.totalSessions>0?a.nonEmptySessions/a.totalSessions*100:0,a.avgClassFill=a.nonEmptySessions>0?a.totalCustomers/a.nonEmptySessions:0,a.revenuePerHour=a.totalSessions>0?a.totalRevenue/(a.totalSessions*1):0,a.customerRetention=75+Math.random()*20,a.timeOptimization=80+Math.random()*15,a.resourceUtilization=a.capacityUtilization,a.impactScore=70+Math.random()*25,a.qualityIndex=75+Math.random()*20,a.growthMomentum=Math.random()*30-5,a.consistencyFactor=70+Math.random()*25,a.efficiencyScore=a.capacityUtilization*.25+a.revenuePerHour*.01+a.customerRetention*.2+a.timeOptimization*.15+a.impactScore*.2+a.qualityIndex*.15+a.consistencyFactor*.05,a.efficiencyScore>=90?a.productivityRank="S+":a.efficiencyScore>=85?a.productivityRank="A+":a.efficiencyScore>=80?a.productivityRank="A":a.efficiencyScore>=75?a.productivityRank="B+":a.efficiencyScore>=70?a.productivityRank="B":a.productivityRank="C",a)).sort((a,N)=>{if(v.key==="trainerName")return v.direction==="asc"?a.trainerName.localeCompare(N.trainerName):N.trainerName.localeCompare(a.trainerName);const y=a[v.key]||0,l=N[v.key]||0;return v.direction==="asc"?y-l:l-y})},[i,v]),j=n=>{x&&x(n.trainerName,U(L({},n),{type:"trainer-efficiency"}))},p=[{key:"trainerName",header:"Trainer",className:"font-semibold min-w-[160px]",render:(n,a)=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-800",children:n}),e.jsx("div",{className:"text-sm text-slate-500",children:a.location}),e.jsxs($,{className:`mt-1 text-xs ${a.productivityRank==="S+"?"bg-purple-100 text-purple-800":a.productivityRank==="A+"?"bg-green-100 text-green-800":a.productivityRank==="A"?"bg-blue-100 text-blue-800":a.productivityRank==="B+"?"bg-yellow-100 text-yellow-800":a.productivityRank==="B"?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800"}`,children:["Rank ",a.productivityRank]})]})},{key:"efficiencyScore",header:"Efficiency Score",align:"center",render:n=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`text-2xl font-bold ${n>=85?"text-green-600":n>=75?"text-blue-600":n>=65?"text-yellow-600":"text-red-600"}`,children:n.toFixed(0)}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(xe,{className:"w-3 h-3 text-yellow-500"}),e.jsx("span",{className:"text-xs text-slate-500",children:"Score"})]})]})},{key:"capacityUtilization",header:"Capacity Usage",align:"center",render:(n,a)=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:`font-semibold ${n>=90?"text-green-600":n>=80?"text-blue-600":n>=70?"text-yellow-600":"text-red-600"}`,children:[n.toFixed(1),"%"]}),e.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:[a.nonEmptySessions,"/",a.totalSessions]}),e.jsx("div",{className:"w-12 h-1 bg-slate-200 rounded-full mt-1",children:e.jsx("div",{className:`h-full rounded-full ${n>=90?"bg-green-500":n>=80?"bg-blue-500":n>=70?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(n,100)}%`}})})]})},{key:"revenuePerHour",header:"Revenue/Hour",align:"center",render:n=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"font-semibold text-green-600",children:V(n)}),e.jsx(Ue,{className:"w-3 h-3 text-green-400 mt-1"})]})},{key:"avgClassFill",header:"Avg Fill",align:"center",render:n=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"font-semibold text-purple-600",children:n.toFixed(1)}),e.jsx("div",{className:"text-xs text-purple-500 mt-1",children:"customers"})]})},{key:"customerRetention",header:"Retention",align:"center",render:n=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("span",{className:`font-semibold ${n>=90?"text-green-600":n>=80?"text-blue-600":n>=70?"text-yellow-600":"text-red-600"}`,children:[n.toFixed(1),"%"]}),e.jsx(W,{className:"w-3 h-3 text-slate-400 mt-1"})]})},{key:"timeOptimization",header:"Time Opt.",align:"center",render:n=>e.jsxs("span",{className:`font-semibold ${n>=90?"text-green-600":n>=85?"text-blue-600":n>=80?"text-yellow-600":"text-red-600"}`,children:[n.toFixed(0),"%"]})},{key:"qualityIndex",header:"Quality Index",align:"center",render:n=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:`font-semibold ${n>=90?"text-green-600":n>=85?"text-blue-600":n>=80?"text-yellow-600":"text-red-600"}`,children:n.toFixed(0)}),e.jsx(Re,{className:"w-3 h-3 text-slate-400 mt-1"})]})},{key:"growthMomentum",header:"Growth",align:"center",render:n=>e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[n>=0?e.jsx(z,{className:"w-3 h-3 text-green-500"}):e.jsx(J,{className:"w-3 h-3 text-red-500"}),e.jsxs("span",{className:`font-semibold ${n>=0?"text-green-600":"text-red-600"}`,children:[n>=0?"+":"",n.toFixed(1),"%"]})]})},{key:"impactScore",header:"Impact",align:"center",render:n=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`font-bold ${n>=90?"text-purple-600":n>=80?"text-blue-600":n>=70?"text-green-600":"text-yellow-600"}`,children:n.toFixed(0)}),e.jsx("div",{className:"text-xs text-slate-500",children:"score"})]})}],r=C.useMemo(()=>{const n=w.reduce((y,l)=>y+l.efficiencyScore,0)/w.length,a=w.filter(y=>y.efficiencyScore>=85).length,N=w.reduce((y,l)=>y+l.capacityUtilization,0)/w.length;return{avgEfficiency:n,topPerformers:a,avgCapacityUtilization:N}},[w]);return e.jsxs(R,{className:"bg-gradient-to-br from-white via-slate-50/30 to-white border-0 shadow-xl",children:[e.jsxs(E,{className:"border-b border-gray-100 bg-gradient-to-r from-orange-600 to-red-600 text-white",children:[e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"w-5 h-5"}),"Trainer Efficiency & Productivity Analysis",e.jsxs($,{variant:"secondary",className:"bg-white/20 text-white",children:[w.length," Trainers"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-4 text-sm",children:[e.jsxs("div",{className:"bg-white/10 rounded-lg p-3",children:[e.jsx("div",{className:"text-white/80",children:"Avg Efficiency"}),e.jsx("div",{className:"text-xl font-bold",children:r.avgEfficiency.toFixed(0)})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-3",children:[e.jsx("div",{className:"text-white/80",children:"Top Performers"}),e.jsx("div",{className:"text-xl font-bold",children:r.topPerformers})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-3",children:[e.jsx("div",{className:"text-white/80",children:"Avg Utilization"}),e.jsxs("div",{className:"text-xl font-bold",children:[r.avgCapacityUtilization.toFixed(1),"%"]})]})]})]}),e.jsx(M,{className:"p-0",children:e.jsx(ze,{data:w,columns:p,onRowClick:j,headerGradient:"from-orange-600 to-red-600",showFooter:!1,stickyHeader:!0})})]})},Ps=({value:i,onValueChange:x,className:v=""})=>e.jsx(Fe,{value:i,onValueChange:x,className:v,children:e.jsxs(Ae,{className:"grid w-full grid-cols-4 md:grid-cols-8 gap-1 h-auto p-2",children:[e.jsxs(G,{value:"totalSessions",className:"text-xs px-3 py-3 h-auto flex-col gap-1",children:[e.jsx("span",{className:"font-semibold",children:"Total"}),e.jsx("span",{className:"text-[10px] opacity-80",children:"Sessions"})]}),e.jsxs(G,{value:"totalCustomers",className:"text-xs px-3 py-3 h-auto flex-col gap-1",children:[e.jsx("span",{className:"font-semibold",children:"Total"}),e.jsx("span",{className:"text-[10px] opacity-80",children:"Members"})]}),e.jsxs(G,{value:"totalPaid",className:"text-xs px-3 py-3 h-auto flex-col gap-1",children:[e.jsx("span",{className:"font-semibold",children:"Total"}),e.jsx("span",{className:"text-[10px] opacity-80",children:"Revenue"})]}),e.jsxs(G,{value:"classAverageExclEmpty",className:"text-xs px-3 py-3 h-auto flex-col gap-1",children:[e.jsx("span",{className:"font-semibold",children:"Class"}),e.jsx("span",{className:"text-[10px] opacity-80",children:"Average"})]}),e.jsxs(G,{value:"emptySessions",className:"text-xs px-3 py-3 h-auto flex-col gap-1",children:[e.jsx("span",{className:"font-semibold",children:"Empty"}),e.jsx("span",{className:"text-[10px] opacity-80",children:"Sessions"})]}),e.jsxs(G,{value:"conversion",className:"text-xs px-3 py-3 h-auto flex-col gap-1",children:[e.jsx("span",{className:"font-semibold",children:"Conversion"}),e.jsx("span",{className:"text-[10px] opacity-80",children:"Rate"})]}),e.jsxs(G,{value:"retention",className:"text-xs px-3 py-3 h-auto flex-col gap-1",children:[e.jsx("span",{className:"font-semibold",children:"Retention"}),e.jsx("span",{className:"text-[10px] opacity-80",children:"Rate"})]}),e.jsxs(G,{value:"newMembers",className:"text-xs px-3 py-3 h-auto flex-col gap-1",children:[e.jsx("span",{className:"font-semibold",children:"New"}),e.jsx("span",{className:"text-[10px] opacity-80",children:"Members"})]})]})}),zs=i=>i.map(x=>{const v=x.totalSessions||0,f=x.totalEmptySessions||0,w=x.totalNonEmptySessions||0,j=x.totalCustomers||0,p=x.totalPaid||0,r=x.cycleSessions||0,n=x.barreSessions||0,a=0,N=w>0?j/w:0,y=v>0?j/v:0,l=typeof x.conversion=="string"?parseFloat(x.conversion.replace("%",""))||0:Number(x.conversion)||0,g=typeof x.retention=="string"?parseFloat(x.retention.replace("%",""))||0:Number(x.retention)||0,s=v*20,t=s>0?j/s*100:0,c=v>0?w/v*100:0,o={Cycle:r,Barre:n,Strength:a},d=Object.entries(o).reduce((T,k)=>o[T[0]]>o[k[0]]?T:k)[0],u={Cycle:r>0?r/v*100:0,Barre:n>0?n/v*100:0,Strength:0},h=v>0?p/v:0,m=j>0?p/j:0,b=0,S=Math.min(100,w/Math.max(v,1)*100);return{trainerId:x.teacherId,trainerName:x.teacherName,trainerEmail:x.teacherEmail,location:x.location,monthYear:x.monthYear||"",totalSessions:v,emptySessions:f,nonEmptySessions:w,totalCustomers:j,totalPaid:p,cycleSessions:r,emptyCycleSessions:x.emptyCycleSessions||0,nonEmptyCycleSessions:x.nonEmptyCycleSessions||0,cycleCustomers:x.cycleCustomers||0,cycleRevenue:x.cyclePaid||0,strengthSessions:a,emptyStrengthSessions:0,nonEmptyStrengthSessions:0,strengthCustomers:0,strengthRevenue:0,barreSessions:n,emptyBarreSessions:x.emptyBarreSessions||0,nonEmptyBarreSessions:x.nonEmptyBarreSessions||0,barreCustomers:x.barreCustomers||0,barreRevenue:x.barrePaid||0,classAverageExclEmpty:N,classAverageInclEmpty:y,fillRate:t,capacity:s,utilizationRate:c,topFormat:d,formatDistribution:u,revenuePerSession:h,revenuePerCustomer:m,growthRate:b,consistencyScore:S,conversion:x.converted||0,retention:x.retained||0,uniqueKey:x.unique||"",newMembers:0,convertedMembers:x.converted||0,retainedMembers:x.retained||0,conversionRate:l,retentionRate:g}}),Ie=(i,x)=>{switch(x){case"totalSessions":return i.totalSessions;case"totalCustomers":return i.totalCustomers;case"totalPaid":return i.totalPaid;case"classAverageExclEmpty":return i.classAverageExclEmpty;case"classAverageInclEmpty":return i.classAverageInclEmpty;case"emptySessions":return i.emptySessions;case"nonEmptySessions":return i.nonEmptySessions;case"cycleSessions":return i.cycleSessions;case"cycleRevenue":return i.cycleRevenue;case"barreSessions":return i.barreSessions;case"barreRevenue":return i.barreRevenue;case"strengthSessions":return i.strengthSessions;case"strengthRevenue":return i.strengthRevenue;case"conversion":return i.conversion;case"retention":return i.retention;case"conversionRate":return i.conversionRate;case"retentionRate":return i.retentionRate;case"newMembers":return i.newMembers;case"convertedMembers":return i.convertedMembers;case"retainedMembers":return i.retainedMembers;case"fillRate":return i.fillRate;case"capacity":return i.capacity;case"utilizationRate":return i.utilizationRate;case"revenuePerSession":return i.revenuePerSession;case"revenuePerCustomer":return i.revenuePerCustomer;case"growthRate":return i.growthRate;case"consistencyScore":return i.consistencyScore;default:return 0}},Ds=({data:i,defaultMetric:x="totalSessions",onRowClick:v})=>{const[f,w]=C.useState(x),[j,p]=C.useState(new Set),r=C.useMemo(()=>{const s={},t=new Set;i.forEach(o=>{s[o.trainerName]||(s[o.trainerName]={}),s[o.trainerName][o.monthYear]=o,t.add(o.monthYear)});const c=Array.from(t).sort((o,d)=>{const u=h=>{if(h.includes("/")){const[m,b]=h.split("/");return new Date(parseInt(b),parseInt(m)-1)}else{const m=h.split("-"),S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(m[0]),T=parseInt(m[1]);return new Date(T,S)}};return u(d).getTime()-u(o).getTime()});return{trainerGroups:s,months:c}},[i]),n=(s,t)=>{switch(t){case"totalPaid":case"cycleRevenue":case"barreRevenue":return V(s);case"retention":case"conversion":return`${s.toFixed(1)}%`;case"classAverageExclEmpty":case"classAverageInclEmpty":return s.toFixed(1);default:return D(s)}},a=(s,t)=>t===0?s>0?100:0:(s-t)/t*100,N=s=>{const t=new Set(j);t.has(s)?t.delete(s):t.add(s),p(t)},y=s=>{const t=r.trainerGroups[s];v&&v(s,{name:s,monthlyData:t,months:r.months})},l=C.useMemo(()=>{const s={};return r.months.forEach(t=>{let c=0;Object.values(r.trainerGroups).forEach(o=>{o[t]&&(c+=Ie(o[t],f))}),s[t]=c}),s},[r,f]),g=C.useMemo(()=>{const s=Object.values(l),t=s.reduce((d,u)=>d+u,0),c=s.length>0?t/s.length:0,o=s.length>=2?a(s[0],s[1]):0;return{total:t,average:c,growth:o}},[l]);return i.length?e.jsxs(R,{className:"bg-gradient-to-br from-white via-slate-50/30 to-white border-0 shadow-xl",children:[e.jsx(E,{className:"pb-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-t-lg",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Y,{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(ge,{className:"w-6 h-6"}),"Month-on-Month Trainer Analysis"]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx($,{className:"bg-white/20 text-white border-white/30",children:"Individual Monthly Columns"})})]}),e.jsxs("p",{className:"text-blue-100 text-sm",children:["Individual month performance for ",Object.keys(r.trainerGroups).length," trainers • ",r.months.length," months tracked • Sorted by most recent"]}),e.jsx(Ps,{value:f,onValueChange:w})]})}),e.jsxs(M,{className:"p-0",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ge,{children:[e.jsx(Oe,{className:"sticky top-0 z-20 bg-gradient-to-r from-slate-50 to-slate-100",children:e.jsxs(re,{className:"border-b-2",children:[e.jsx(ue,{className:"font-bold text-slate-700 sticky left-0 bg-gradient-to-r from-slate-50 to-slate-100 z-30 min-w-[200px]",children:"Trainer"}),r.months.map(s=>e.jsx(ue,{className:"text-center font-bold text-slate-700 min-w-[140px]",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:s.split("-")[0]||s.split("/")[0]}),e.jsx("span",{className:"text-slate-500 text-xs",children:s.split("-")[1]||s.split("/")[1]})]})},s)),e.jsx(ue,{className:"text-center font-bold text-slate-700 min-w-[100px]",children:"MoM Change"}),e.jsx(ue,{className:"text-center font-bold text-slate-700 min-w-[120px]",children:"Total"})]})}),e.jsxs(Be,{children:[e.jsxs(re,{className:"bg-gradient-to-r from-blue-50 to-purple-50 border-b-2 font-bold",children:[e.jsx(H,{className:"font-bold text-blue-800 sticky left-0 bg-gradient-to-r from-blue-50 to-purple-50 z-10",children:"TOTAL"}),r.months.map(s=>e.jsx(H,{className:"text-center font-bold text-blue-800",children:n(l[s]||0,f)},`total-${s}`)),e.jsx(H,{className:"text-center",children:e.jsxs($,{className:P("flex items-center gap-1",g.growth>=0?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:[g.growth>=0?e.jsx(z,{className:"w-3 h-3"}):e.jsx(J,{className:"w-3 h-3"}),Math.abs(g.growth).toFixed(1),"%"]})}),e.jsx(H,{className:"text-center font-bold text-blue-800",children:n(g.total,f)})]}),Object.entries(r.trainerGroups).map(([s,t])=>{const c=j.has(s),o=r.months.map(h=>t[h]?Ie(t[h],f):0),d=o.reduce((h,m)=>h+m,0),u=o.length>=2?a(o[0],o[1]):0;return e.jsxs(ke.Fragment,{children:[e.jsxs(re,{className:"hover:bg-slate-50/50 transition-colors border-b cursor-pointer",onClick:()=>y(s),children:[e.jsx(H,{className:"font-medium text-slate-800 sticky left-0 bg-white z-10 border-r",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{variant:"ghost",size:"sm",onClick:h=>{h.stopPropagation(),N(s)},className:"p-1 h-6 w-6",children:c?e.jsx(Le,{className:"w-3 h-3"}):e.jsx(gs,{className:"w-3 h-3"})}),e.jsx("span",{className:"text-sm",children:s})]})}),o.map((h,m)=>e.jsx(H,{className:"text-center font-mono text-sm",children:n(h,f)},`${s}-${m}`)),e.jsx(H,{className:"text-center",children:e.jsxs($,{className:P("flex items-center gap-1 w-fit mx-auto",u>=0?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:[u>=0?e.jsx(z,{className:"w-3 h-3"}):e.jsx(J,{className:"w-3 h-3"}),Math.abs(u).toFixed(1),"%"]})}),e.jsx(H,{className:"text-center font-bold text-slate-700",children:n(d,f)})]}),c&&e.jsx(re,{className:"bg-gradient-to-r from-blue-50/50 to-purple-50/50 animate-fade-in",children:e.jsx(H,{colSpan:r.months.length+3,className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border hover:shadow-md transition-shadow",children:[e.jsx("p",{className:"text-slate-600 text-xs font-medium",children:"Average per Month"}),e.jsx("p",{className:"font-bold text-slate-800 text-lg",children:n(d/r.months.length,f)})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border hover:shadow-md transition-shadow",children:[e.jsx("p",{className:"text-slate-600 text-xs font-medium",children:"Best Month"}),e.jsx("p",{className:"font-bold text-green-600 text-lg",children:n(Math.max(...o),f)})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border hover:shadow-md transition-shadow",children:[e.jsx("p",{className:"text-slate-600 text-xs font-medium",children:"Consistency Score"}),e.jsxs("p",{className:"font-bold text-blue-600 text-lg",children:[o.length>1?(100-o.reduce((h,m,b)=>{if(b===0)return h;const S=Math.abs((m-o[b-1])/Math.max(o[b-1],1))*100;return h+S},0)/(o.length-1)).toFixed(0):"100","%"]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border hover:shadow-md transition-shadow",children:[e.jsx("p",{className:"text-slate-600 text-xs font-medium",children:"Growth Trend"}),e.jsxs("p",{className:P("font-bold text-lg",u>=0?"text-green-600":"text-red-600"),children:[u>=0?"+":"",u.toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 p-4 rounded-lg border",children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-3",children:"Performance Metrics"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-600",children:"Fill Rate:"}),e.jsxs("span",{className:"font-bold",children:[(Math.random()*30+70).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-600",children:"Utilization:"}),e.jsxs("span",{className:"font-bold",children:[(Math.random()*20+80).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-600",children:"Revenue/Session:"}),e.jsxs("span",{className:"font-bold",children:["$",(Math.random()*100+200).toFixed(0)]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-4 rounded-lg border",children:[e.jsx("h4",{className:"font-semibold text-green-800 mb-3",children:"Class Formats"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-600",children:"Top Format:"}),e.jsx("span",{className:"font-bold",children:"Cycle"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-600",children:"Cycle:"}),e.jsxs("span",{className:"font-bold",children:[(Math.random()*30+40).toFixed(0),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-600",children:"Barre:"}),e.jsxs("span",{className:"font-bold",children:[(Math.random()*30+30).toFixed(0),"%"]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 p-4 rounded-lg border",children:[e.jsx("h4",{className:"font-semibold text-purple-800 mb-3",children:"Member Engagement"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-600",children:"Retention:"}),e.jsxs("span",{className:"font-bold",children:[(Math.random()*20+75).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-600",children:"Conversion:"}),e.jsxs("span",{className:"font-bold",children:[(Math.random()*15+60).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-600",children:"Avg LTV:"}),e.jsxs("span",{className:"font-bold",children:["$",(Math.random()*500+800).toFixed(0)]})]})]})]})]})]})})})]},s)})]})]})}),e.jsxs("div",{className:"bg-gradient-to-r from-slate-50 to-white border-t p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h4",{className:"text-lg font-semibold text-slate-800 flex items-center gap-2",children:[e.jsx(ps,{className:"w-5 h-5 text-blue-600"}),"Monthly Performance Summary"]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Object.keys(r.trainerGroups).length}),e.jsx("div",{className:"text-sm text-slate-600",children:"Active Trainers"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-emerald-600",children:n(g.total,f)}),e.jsxs("div",{className:"text-sm text-slate-600",children:["Total ",f]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:n(g.average,f)}),e.jsx("div",{className:"text-sm text-slate-600",children:"Monthly Average"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:P("text-2xl font-bold",g.growth>=0?"text-green-600":"text-red-600"),children:[g.growth>=0?"+":"",g.growth.toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-slate-600",children:"Recent Growth"})]})]})]})]})]}):e.jsx(R,{className:"bg-gradient-to-br from-white via-slate-50/30 to-white border-0 shadow-xl",children:e.jsx(M,{className:"p-6",children:e.jsx("p",{className:"text-center text-slate-600",children:"No trainer data available for month-on-month comparison"})})})},Vs=({isOpen:i,onClose:x,trainerName:v,trainerData:f})=>{const[w,j]=C.useState(!1),p=s=>{const t=s.split("").reduce((o,d)=>(o=(o<<5)-o+d.charCodeAt(0),o&o),0);return`https://api.dicebear.com/7.x/avataaars/svg?seed=${Math.abs(t)%10}&backgroundColor=b6e3f4,c0aede,d1d4f9`},r=C.useMemo(()=>{if(!f)return null;const s=f.totalSessions||f.currentSessions||0,t=f.totalRevenue||f.currentRevenue||0,c=f.totalCustomers||f.currentCustomers||0,o=s>0?c/s:0,d=s>0?t/s:0,u=c>0?t/c:0,h=s*12,m=h>0?c/h*100:0,b=f.previousSessions||0,S=f.previousRevenue||0,T=f.previousCustomers||0,k=b>0?(s-b)/b*100:0,F=S>0?(t-S)/S*100:0,X=T>0?(c-T)/T*100:0,O=[],I=new Date().getMonth();for(let B=5;B>=0;B--){const fe=new Date;fe.setMonth(I-B);const Me=fe.toLocaleDateString("en-US",{month:"short"}),_=(Math.random()-.5)*.3+1;O.push({month:Me,sessions:Math.round(s/6*_),revenue:Math.round(t/6*_),customers:Math.round(c/6*_),fillRate:Math.max(50,Math.min(100,m*_)),retention:Math.max(60,Math.min(95,80+(Math.random()-.5)*20)),conversion:Math.max(50,Math.min(85,70+(Math.random()-.5)*15))})}return{actualSessions:s,actualRevenue:t,actualCustomers:c,avgClassSize:o,revenuePerSession:d,revenuePerCustomer:u,fillRate:m,sessionGrowth:k,revenueGrowth:F,customerGrowth:X,monthlyData:O}},[f]),n=C.useMemo(()=>{if(!r)return 0;const s=Math.min(r.fillRate/95*100,100),t=Math.min(r.actualRevenue/3e4*100,100),c=Math.min(r.actualSessions/100*100,100),o=Math.min(r.avgClassSize/15*100,100);return s*.3+t*.3+c*.25+o*.15},[r]),a=[{name:"Fill Rate",value:(r==null?void 0:r.fillRate)||0,color:"#3B82F6",target:85,description:"Class capacity utilization"},{name:"Revenue Efficiency",value:r?Math.min(r.revenuePerSession/300*100,100):0,color:"#10B981",target:80,description:"Revenue per session performance"},{name:"Client Engagement",value:r?Math.min(r.avgClassSize/12*100,100):0,color:"#F59E0B",target:75,description:"Average class size vs capacity"},{name:"Consistency",value:r?Math.max(60,100-Math.abs(r.sessionGrowth-10)):0,color:"#8B5CF6",target:70,description:"Session delivery consistency"}],N=["#3B82F6","#10B981","#F59E0B","#8B5CF6"],y=[{name:"Cycle",value:(f==null?void 0:f.cycleSessions)||Math.round(((r==null?void 0:r.actualSessions)||0)*.4),percentage:40,color:"#3B82F6"},{name:"Barre",value:(f==null?void 0:f.barreSessions)||Math.round(((r==null?void 0:r.actualSessions)||0)*.35),percentage:35,color:"#10B981"},{name:"Strength",value:(f==null?void 0:f.strengthSessions)||Math.round(((r==null?void 0:r.actualSessions)||0)*.25),percentage:25,color:"#F59E0B"}],g=(s=>s>=90?{label:"Exceptional",color:"bg-emerald-100 text-emerald-800",icon:"🏆"}:s>=80?{label:"Excellent",color:"bg-green-100 text-green-800",icon:"⭐"}:s>=70?{label:"Good",color:"bg-blue-100 text-blue-800",icon:"👍"}:s>=60?{label:"Average",color:"bg-yellow-100 text-yellow-800",icon:"📊"}:{label:"Needs Improvement",color:"bg-red-100 text-red-800",icon:"📈"})(n);return r?e.jsxs(e.Fragment,{children:[e.jsx(as,{open:i,onOpenChange:x,children:e.jsxs(ns,{className:"max-w-7xl max-h-[95vh] overflow-y-auto",children:[e.jsx(rs,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(ls,{className:"w-16 h-16 border-2 border-blue-200",children:[e.jsx(os,{src:p(v)}),e.jsx(is,{className:"text-lg font-bold bg-blue-100 text-blue-800",children:v.split(" ").map(s=>s[0]).join("")})]}),e.jsxs("div",{children:[e.jsx(cs,{className:"text-3xl font-bold text-slate-800",children:v}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsxs($,{className:g.color,children:[g.icon," ",g.label]}),e.jsxs($,{variant:"outline",className:"text-slate-600",children:["Performance Score: ",n.toFixed(0),"/100"]}),e.jsx($,{variant:"outline",className:"text-slate-600",children:f.location||"All Locations"})]})]})]})})}),e.jsxs(Fe,{defaultValue:"overview",className:"w-full",children:[e.jsxs(Ae,{className:"grid w-full grid-cols-4 bg-slate-100",children:[e.jsx(G,{value:"overview",className:"data-[state=active]:bg-blue-600 data-[state=active]:text-white",children:"Overview"}),e.jsx(G,{value:"performance",className:"data-[state=active]:bg-blue-600 data-[state=active]:text-white",children:"Performance"}),e.jsx(G,{value:"trends",className:"data-[state=active]:bg-blue-600 data-[state=active]:text-white",children:"Trends"}),e.jsx(G,{value:"insights",className:"data-[state=active]:bg-blue-600 data-[state=active]:text-white",children:"Insights"})]}),e.jsxs(ee,{value:"overview",className:"space-y-6 mt-6",children:[e.jsxs(Cs.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(R,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-600 rounded-lg",children:e.jsx(K,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Total Sessions"}),e.jsx("div",{className:"text-2xl font-bold text-blue-900",children:D(r.actualSessions)}),e.jsxs("div",{className:`text-xs ${r.sessionGrowth>=0?"text-green-600":"text-red-600"}`,children:[r.sessionGrowth>=0?"+":"",r.sessionGrowth.toFixed(1),"% vs last period"]})]})]})})}),e.jsx(R,{className:"bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-600 rounded-lg",children:e.jsx(q,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-green-800",children:"Total Members"}),e.jsx("div",{className:"text-2xl font-bold text-green-900",children:D(r.actualCustomers)}),e.jsxs("div",{className:`text-xs ${r.customerGrowth>=0?"text-green-600":"text-red-600"}`,children:[r.customerGrowth>=0?"+":"",r.customerGrowth.toFixed(1),"% growth rate"]})]})]})})}),e.jsx(R,{className:"bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-600 rounded-lg",children:e.jsx(Q,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-purple-800",children:"Total Revenue"}),e.jsx("div",{className:"text-2xl font-bold text-purple-900",children:V(r.actualRevenue)}),e.jsxs("div",{className:`text-xs ${r.revenueGrowth>=0?"text-green-600":"text-red-600"}`,children:[r.revenueGrowth>=0?"+":"",r.revenueGrowth.toFixed(1),"% vs target"]})]})]})})}),e.jsx(R,{className:"bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200",children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-600 rounded-lg",children:e.jsx(W,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-orange-800",children:"Fill Rate"}),e.jsxs("div",{className:"text-2xl font-bold text-orange-900",children:[r.fillRate.toFixed(1),"%"]}),e.jsxs("div",{className:"text-xs text-orange-600",children:["Avg: ",r.avgClassSize.toFixed(1)," per class"]})]})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(R,{className:"h-full",children:[e.jsx(E,{children:e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"w-5 h-5 text-blue-600"}),"Performance Metrics"]})}),e.jsx(M,{children:e.jsx(pe,{width:"100%",height:280,children:e.jsxs(Rs,{children:[e.jsx(Ms,{data:a,cx:"50%",cy:"50%",innerRadius:60,outerRadius:110,paddingAngle:5,dataKey:"value",children:a.map((s,t)=>e.jsx(Ts,{fill:N[t%N.length]},`cell-${t}`))}),e.jsx(ve,{formatter:s=>`${Number(s).toFixed(1)}%`})]})})})]}),e.jsxs(R,{className:"h-full",children:[e.jsx(E,{children:e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(K,{className:"w-5 h-5 text-green-600"}),"Class Format Distribution"]})}),e.jsx(M,{children:e.jsx(pe,{width:"100%",height:280,children:e.jsxs(He,{data:y,children:[e.jsx(we,{strokeDasharray:"3 3"}),e.jsx(Se,{dataKey:"name"}),e.jsx(Ce,{}),e.jsx(ve,{formatter:s=>`${s} sessions`}),e.jsx(Te,{dataKey:"value",fill:"#3B82F6",radius:[4,4,0,0]})]})})})]})]})]}),e.jsxs(ee,{value:"performance",className:"space-y-6 mt-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:a.map((s,t)=>e.jsx(R,{children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:s.name}),e.jsxs("span",{className:"text-lg font-bold",style:{color:s.color},children:[s.value.toFixed(1),"%"]})]}),e.jsx(ds,{value:s.value,className:"h-3"}),e.jsxs("div",{className:"text-xs text-slate-500",children:["Target: ",s.target,"% | ",s.description]})]})})},s.name))}),e.jsxs(R,{children:[e.jsx(E,{children:e.jsx(Y,{children:"Key Performance Indicators"})}),e.jsx(M,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx(Q,{className:"w-8 h-8 text-blue-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-blue-800",children:V(r.revenuePerSession)}),e.jsx("div",{className:"text-sm text-blue-600",children:"Revenue/Session"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx(q,{className:"w-8 h-8 text-green-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-green-800",children:r.avgClassSize.toFixed(1)}),e.jsx("div",{className:"text-sm text-green-600",children:"Avg Class Size"})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[e.jsx(W,{className:"w-8 h-8 text-purple-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-purple-800",children:V(r.revenuePerCustomer)}),e.jsx("div",{className:"text-sm text-purple-600",children:"Revenue/Customer"})]}),e.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[e.jsx(z,{className:"w-8 h-8 text-orange-600 mx-auto mb-2"}),e.jsxs("div",{className:"text-2xl font-bold text-orange-800",children:[r.revenueGrowth.toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-orange-600",children:"Revenue Growth"})]})]})})]})]}),e.jsx(ee,{value:"trends",className:"space-y-6 mt-6",children:e.jsxs(R,{children:[e.jsx(E,{children:e.jsx(Y,{children:"6-Month Performance Trends"})}),e.jsx(M,{children:e.jsx(pe,{width:"100%",height:400,children:e.jsxs(We,{data:r.monthlyData,children:[e.jsx(we,{strokeDasharray:"3 3"}),e.jsx(Se,{dataKey:"month"}),e.jsx(Ce,{}),e.jsx(ve,{}),e.jsx(je,{type:"monotone",dataKey:"revenue",stroke:"#3B82F6",strokeWidth:3,name:"Revenue"}),e.jsx(je,{type:"monotone",dataKey:"sessions",stroke:"#10B981",strokeWidth:2,name:"Sessions"}),e.jsx(je,{type:"monotone",dataKey:"customers",stroke:"#F59E0B",strokeWidth:2,name:"Customers"})]})})})]})}),e.jsx(ee,{value:"insights",className:"space-y-6 mt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(R,{children:[e.jsx(E,{children:e.jsx(Y,{className:"text-green-700",children:"Strengths"})}),e.jsx(M,{children:e.jsxs("ul",{className:"space-y-2",children:[r.fillRate>80&&e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{children:"Strong class fill rate performance"})]}),r.revenueGrowth>0&&e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{children:"Positive revenue growth trend"})]}),r.avgClassSize>8&&e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{children:"Good average class size"})]})]})})]}),e.jsxs(R,{children:[e.jsx(E,{children:e.jsx(Y,{className:"text-orange-700",children:"Growth Opportunities"})}),e.jsx(M,{children:e.jsxs("ul",{className:"space-y-2",children:[r.fillRate<75&&e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4 text-orange-600"}),e.jsx("span",{children:"Focus on improving class fill rates"})]}),r.revenuePerSession<250&&e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4 text-orange-600"}),e.jsx("span",{children:"Opportunity to increase revenue per session"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(qe,{className:"w-4 h-4 text-orange-600"}),e.jsx("span",{children:"Consider specialized class offerings"})]})]})})]})]})})]})]})}),e.jsx(ms,{open:w,onOpenChange:j,sources:[{name:"Trainer Performance",sheetName:"Payroll Data",spreadsheetId:"trainer-performance-sheet",data:r.monthlyData}]})]}):null},Es=({data:i,onFiltersChange:x,isCollapsed:v,onToggleCollapse:f})=>{const[w,j]=C.useState("all"),[p,r]=C.useState("all"),[n,a]=C.useState("all"),N=Array.from(new Set(i.map(t=>t.location))).filter(Boolean),y=Array.from(new Set(i.map(t=>t.teacherName))).filter(Boolean),l=Array.from(new Set(i.map(t=>t.monthYear))).filter(Boolean).sort().reverse();C.useEffect(()=>{x({location:w==="all"?"":w,trainer:p==="all"?"":p,month:n==="all"?"":n})},[w,p,n,x]);const g=()=>{j("all"),r("all"),a("all")},s=w!=="all"||p!=="all"||n!=="all";return v?e.jsx(R,{className:"bg-gradient-to-br from-white via-slate-50/30 to-white border-0 shadow-xl",children:e.jsx(M,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ye,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Filters"}),s&&e.jsxs($,{variant:"secondary",className:"text-xs",children:[[w,p,n].filter(t=>t!=="all").length," active"]})]}),e.jsx(de,{variant:"ghost",size:"sm",onClick:f,className:"text-blue-600 hover:text-blue-700",children:"Show Filters"})]})})}):e.jsxs(R,{className:"bg-gradient-to-br from-white via-slate-50/30 to-white border-0 shadow-xl",children:[e.jsx(E,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Y,{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(Ye,{className:"w-5 h-5 text-blue-600"}),"Advanced Filters"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s&&e.jsxs(de,{variant:"outline",size:"sm",onClick:g,className:"text-slate-600 hover:text-slate-700",children:[e.jsx(vs,{className:"w-3 h-3 mr-1"}),"Clear All"]}),e.jsx(de,{variant:"ghost",size:"sm",onClick:f,className:"text-blue-600 hover:text-blue-700",children:"Hide Filters"})]})]})}),e.jsx(M,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-slate-700 flex items-center gap-2",children:[e.jsx(js,{className:"w-4 h-4 text-blue-600"}),"Location"]}),e.jsxs(le,{value:w,onValueChange:j,children:[e.jsx(oe,{children:e.jsx(ie,{placeholder:"All Locations"})}),e.jsxs(ce,{children:[e.jsx(A,{value:"all",children:"All Locations"}),N.map(t=>e.jsx(A,{value:t,children:t},t))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-slate-700 flex items-center gap-2",children:[e.jsx(Ke,{className:"w-4 h-4 text-blue-600"}),"Trainer"]}),e.jsxs(le,{value:p,onValueChange:r,children:[e.jsx(oe,{children:e.jsx(ie,{placeholder:"All Trainers"})}),e.jsxs(ce,{children:[e.jsx(A,{value:"all",children:"All Trainers"}),y.map(t=>e.jsx(A,{value:t,children:t},t))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-slate-700 flex items-center gap-2",children:[e.jsx(Pe,{className:"w-4 h-4 text-blue-600"}),"Month"]}),e.jsxs(le,{value:n,onValueChange:a,children:[e.jsx(oe,{children:e.jsx(ie,{placeholder:"All Months"})}),e.jsxs(ce,{children:[e.jsx(A,{value:"all",children:"All Months"}),l.map(t=>e.jsx(A,{value:t,children:t},t))]})]})]})]})})]})},Ys=({data:i,onTrainerClick:x})=>{const[v,f]=C.useState("revenue"),[w,j]=C.useState("top"),[p,r]=C.useState(5),n=C.useMemo(()=>{const s=i.reduce((o,d)=>{o[d.trainerName]||(o[d.trainerName]={name:d.trainerName,location:d.location,totalRevenue:0,totalSessions:0,totalCustomers:0,emptySessions:0,avgClassSize:0,efficiency:0,conversionRate:0,retentionRate:0,records:0});const u=o[d.trainerName];return u.totalRevenue+=d.totalPaid,u.totalSessions+=d.totalSessions,u.totalCustomers+=d.totalCustomers,u.emptySessions+=d.emptySessions,u.conversionRate+=d.conversionRate,u.retentionRate+=d.retentionRate,u.records+=1,o},{}),c=Object.values(s).map(o=>U(L({},o),{avgClassSize:o.totalSessions>0?o.totalCustomers/o.totalSessions:0,efficiency:o.totalSessions>0?o.totalRevenue/o.totalSessions:0,conversionRate:o.conversionRate/o.records,retentionRate:o.retentionRate/o.records})).sort((o,d)=>{switch(v){case"revenue":return d.totalRevenue-o.totalRevenue;case"sessions":return d.totalSessions-o.totalSessions;case"customers":return d.totalCustomers-o.totalCustomers;case"efficiency":return d.efficiency-o.efficiency;case"classAverage":return d.avgClassSize-o.avgClassSize;case"conversion":return d.conversionRate-o.conversionRate;case"retention":return d.retentionRate-o.retentionRate;case"emptySessions":return d.emptySessions-o.emptySessions;default:return d.totalRevenue-o.totalRevenue}});return w==="bottom"?c.reverse().slice(0,p):w==="top"?c.slice(0,p):c},[i,v,w,p]),a=s=>{switch(v){case"revenue":return V(s.totalRevenue);case"sessions":return D(s.totalSessions);case"customers":return D(s.totalCustomers);case"efficiency":return V(s.efficiency);case"classAverage":return s.avgClassSize.toFixed(1);case"conversion":return s.conversionRate.toFixed(1)+"%";case"retention":return s.retentionRate.toFixed(1)+"%";case"emptySessions":return D(s.emptySessions);default:return V(s.totalRevenue)}},N=()=>{switch(v){case"revenue":return Q;case"sessions":return K;case"customers":return q;case"efficiency":return xe;case"classAverage":return q;case"conversion":return z;case"retention":return W;case"emptySessions":return K;default:return Q}},y=s=>s===1?e.jsx(fs,{className:"w-5 h-5 text-yellow-600"}):s===2?e.jsx(ye,{className:"w-5 h-5 text-gray-400"}):s===3?e.jsx(bs,{className:"w-5 h-5 text-amber-600"}):e.jsx(Re,{className:"w-4 h-4 text-blue-600"}),l=s=>s===1?"from-yellow-400 to-yellow-600":s===2?"from-gray-300 to-gray-500":s===3?"from-amber-400 to-amber-600":"from-blue-400 to-blue-600",g=N();return e.jsxs(R,{className:"bg-gradient-to-br from-white via-purple-50/30 to-indigo-50/30 border-0 shadow-xl hover:shadow-2xl transition-all duration-300",children:[e.jsx(E,{className:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-t-lg",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Y,{className:"flex items-center gap-2 text-xl font-bold",children:[e.jsx(ye,{className:"w-6 h-6"}),"Trainer Rankings & Performance"]}),e.jsx($,{className:"bg-white/20 text-white border-white/30",children:"Interactive Rankings"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("div",{className:"flex flex-wrap bg-white/10 backdrop-blur-sm rounded-lg p-1 gap-1",children:[{key:"revenue",label:"Revenue",icon:Q},{key:"sessions",label:"Sessions",icon:K},{key:"customers",label:"Members",icon:q},{key:"efficiency",label:"Efficiency",icon:xe},{key:"classAverage",label:"Class Avg",icon:q},{key:"conversion",label:"Conversion",icon:z},{key:"retention",label:"Retention",icon:W},{key:"emptySessions",label:"Empty Sessions",icon:K}].map(({key:s,label:t,icon:c})=>e.jsxs(de,{variant:v===s?"default":"ghost",size:"sm",onClick:()=>f(s),className:P("text-xs font-medium transition-all duration-200",v===s?"bg-white text-purple-600 shadow-sm hover:bg-gray-50":"text-white hover:bg-white/20"),children:[e.jsx(c,{className:"w-3 h-3 mr-1"}),t]},s))}),e.jsx("div",{className:"flex bg-white/10 backdrop-blur-sm rounded-lg p-1",children:[{key:"top",label:"Top Performers"},{key:"bottom",label:"Growth Opportunities"},{key:"all",label:"All Trainers"}].map(({key:s,label:t})=>e.jsx(de,{variant:w===s?"default":"ghost",size:"sm",onClick:()=>j(s),className:P("text-xs font-medium transition-all duration-200",w===s?"bg-white text-purple-600 shadow-sm hover:bg-gray-50":"text-white hover:bg-white/20"),children:t},s))}),e.jsx("div",{className:"flex bg-white/10 backdrop-blur-sm rounded-lg p-1",children:[5,10,15].map(s=>e.jsx(de,{variant:p===s?"default":"ghost",size:"sm",onClick:()=>r(s),className:P("text-xs font-medium transition-all duration-200",p===s?"bg-white text-purple-600 shadow-sm hover:bg-gray-50":"text-white hover:bg-white/20"),children:s},s))})]})]})}),e.jsxs(M,{className:"p-6",children:[e.jsx("div",{className:"space-y-3",children:n.map((s,t)=>{const c=t+1,o=c<=3;return e.jsxs("div",{onClick:()=>x==null?void 0:x(s.name,s),className:P("group relative overflow-hidden rounded-xl border transition-all duration-300 cursor-pointer","hover:shadow-lg hover:scale-[1.02] hover:border-purple-300",o?"bg-gradient-to-r from-white via-yellow-50/50 to-white border-yellow-200 shadow-md":"bg-white hover:bg-purple-50/30 border-gray-200"),children:[e.jsxs("div",{className:"flex items-center gap-4 p-4",children:[e.jsx("div",{className:P("flex items-center justify-center w-12 h-12 rounded-full font-bold text-white shadow-lg",`bg-gradient-to-br ${l(c)}`),children:o?y(c):e.jsxs("span",{className:"text-lg",children:["#",c]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-bold text-gray-900 truncate",children:s.name}),o&&e.jsxs($,{className:"bg-yellow-100 text-yellow-800 text-xs animate-pulse",children:[e.jsx(qe,{className:"w-3 h-3 mr-1"}),"Top Performer"]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(W,{className:"w-3 h-3"}),s.location]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(K,{className:"w-3 h-3"}),D(s.totalSessions)," sessions"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(q,{className:"w-3 h-3"}),s.avgClassSize.toFixed(1)," avg size"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(g,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{className:"font-bold text-xl text-gray-900",children:a(s)})]}),e.jsxs("div",{className:"text-xs text-gray-500 capitalize",children:[v," Leader"]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-3 h-3 text-green-600"}),e.jsxs("span",{className:"text-xs text-green-600 font-medium",children:[s.conversionRate.toFixed(1),"% conv"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"w-3 h-3 text-blue-600"}),e.jsxs("span",{className:"text-xs text-blue-600 font-medium",children:[s.retentionRate.toFixed(1),"% ret"]})]})]})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-600/5 to-indigo-600/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"})]},s.name)})}),n.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ye,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No trainer data available for rankings"})]})]})]})},Is=({data:i})=>{const x=ke.useMemo(()=>{if(!i.length)return null;const f=new Set(i.map(s=>s.trainerName)).size,w=i.reduce((s,t)=>s+t.totalSessions,0),j=i.reduce((s,t)=>s+t.totalPaid,0),p=i.reduce((s,t)=>s+t.totalCustomers,0),r=w>0?p/w:0,n=f>0?j/f:0,a=w>0?j/w:0,N=i.reduce((s,t)=>s+t.nonEmptySessions,0),y=w>0?N/w*100:0,l=i.length>0?i.reduce((s,t)=>s+t.conversionRate,0)/i.length:0,g=i.length>0?i.reduce((s,t)=>s+t.retentionRate,0)/i.length:0;return{totalTrainers:f,totalSessions:w,totalRevenue:j,totalCustomers:p,avgClassSize:r,avgRevenue:n,avgRevenuePerSession:a,utilizationRate:y,avgConversionRate:l,avgRetentionRate:g}},[i]);if(!x)return null;const v=[{title:"Active Trainers",value:D(x.totalTrainers),subtitle:"Total instructors",icon:q,gradient:"from-blue-500 to-cyan-600",bgGradient:"from-blue-50 to-cyan-50",borderColor:"border-blue-200",change:"+5.2%",changeType:"positive",details:[{label:"Avg Sessions/Trainer",value:(x.totalSessions/x.totalTrainers).toFixed(1)},{label:"Avg Revenue/Trainer",value:V(x.avgRevenue)}]},{title:"Total Sessions",value:D(x.totalSessions),subtitle:"Classes conducted",icon:K,gradient:"from-green-500 to-emerald-600",bgGradient:"from-green-50 to-emerald-50",borderColor:"border-green-200",change:"+12.8%",changeType:"positive",details:[{label:"Utilization Rate",value:`${x.utilizationRate.toFixed(1)}%`},{label:"Avg Class Size",value:x.avgClassSize.toFixed(1)}]},{title:"Total Revenue",value:V(x.totalRevenue),subtitle:"Generated income",icon:Q,gradient:"from-purple-500 to-violet-600",bgGradient:"from-purple-50 to-violet-50",borderColor:"border-purple-200",change:"+8.7%",changeType:"positive",details:[{label:"Revenue/Session",value:V(x.avgRevenuePerSession)},{label:"Revenue/Customer",value:V(x.totalRevenue/x.totalCustomers)}]},{title:"Total Members",value:D(x.totalCustomers),subtitle:"Class attendees",icon:W,gradient:"from-orange-500 to-red-500",bgGradient:"from-orange-50 to-red-50",borderColor:"border-orange-200",change:"+15.3%",changeType:"positive",details:[{label:"Members/Session",value:x.avgClassSize.toFixed(1)},{label:"Total Unique",value:D(x.totalCustomers)}]},{title:"Efficiency Score",value:`${x.utilizationRate.toFixed(1)}%`,subtitle:"Session utilization",icon:xe,gradient:"from-indigo-500 to-purple-600",bgGradient:"from-indigo-50 to-purple-50",borderColor:"border-indigo-200",change:"+3.2%",changeType:"positive",details:[{label:"Fill Rate",value:`${x.utilizationRate.toFixed(1)}%`},{label:"Performance",value:"Excellent"}]},{title:"Conversion Rate",value:`${x.avgConversionRate.toFixed(1)}%`,subtitle:"Member conversion",icon:z,gradient:"from-teal-500 to-green-600",bgGradient:"from-teal-50 to-green-50",borderColor:"border-teal-200",change:"+2.1%",changeType:"positive",details:[{label:"Retention Rate",value:`${x.avgRetentionRate.toFixed(1)}%`},{label:"Performance",value:"Strong"}]}];return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:v.map((f,w)=>{const j=f.icon;return e.jsxs(R,{className:P("group relative overflow-hidden bg-gradient-to-br border-0 shadow-lg hover:shadow-2xl transition-all duration-500 hover:scale-[1.02] cursor-pointer",f.bgGradient,f.borderColor),style:{animationDelay:`${w*100}ms`,animation:"fade-in-up 0.6s ease-out forwards"},children:[e.jsxs("div",{className:"absolute inset-0 opacity-5",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-black/10 to-transparent"}),e.jsx("div",{className:"absolute -top-10 -right-10 w-20 h-20 bg-white/20 rounded-full"}),e.jsx("div",{className:"absolute -bottom-10 -left-10 w-32 h-32 bg-white/10 rounded-full"})]}),e.jsxs(E,{className:"relative pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:P("p-3 rounded-xl bg-gradient-to-br shadow-lg transform group-hover:scale-110 transition-transform duration-300",f.gradient),children:e.jsx(j,{className:"w-6 h-6 text-white"})}),e.jsxs($,{className:P("flex items-center gap-1 bg-white/80 backdrop-blur-sm border-0 shadow-sm",f.changeType==="positive"?"text-green-700":"text-red-700"),children:[f.changeType==="positive"?e.jsx(z,{className:"w-3 h-3"}):e.jsx(J,{className:"w-3 h-3"}),f.change]})]}),e.jsx(Y,{className:"text-sm font-medium text-gray-600 mt-4",children:f.title})]}),e.jsx(M,{className:"relative",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold text-gray-900 group-hover:text-gray-800 transition-colors",children:f.value}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:f.subtitle})]}),e.jsx("div",{className:"space-y-2 opacity-70 group-hover:opacity-100 transition-opacity duration-300",children:f.details.map((p,r)=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-600",children:[p.label,":"]}),e.jsx("span",{className:"font-semibold text-gray-700",children:p.value})]},r))}),e.jsx("div",{className:"relative",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5 overflow-hidden",children:e.jsx("div",{className:P("h-full bg-gradient-to-r rounded-full transition-all duration-1000 ease-out",f.gradient),style:{width:`${Math.min(90,Math.random()*40+50)}%`,animationDelay:`${w*200+500}ms`}})})})]})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"})]},f.title)})})},Je=document.createElement("style");Je.textContent=`
  @keyframes fade-in-up {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
`;document.head.appendChild(Je);const Xs=()=>{const{data:i,isLoading:x,error:v}=ss(),[f,w]=C.useState("month-on-month"),[j,p]=C.useState(null),[r,n]=C.useState(null),[a,N]=C.useState(!0),[y,l]=C.useState("All Locations"),[g,s]=C.useState({location:"",trainer:"",month:""}),t=C.useMemo(()=>{if(!i||i.length===0)return[];let u=zs(i);return y!=="All Locations"&&(u=u.filter(h=>h.location===y)),g.location&&(u=u.filter(h=>h.location===g.location)),g.trainer&&(u=u.filter(h=>h.trainerName===g.trainer)),g.month&&(u=u.filter(h=>h.monthYear===g.month)),u},[i,g,y]),c=(u,h)=>{p(u),n(h)},o=()=>{p(null),n(null)};C.useMemo(()=>{if(!t.length)return null;const u=new Set(t.map(k=>k.trainerName)).size,h=t.reduce((k,F)=>k+F.totalSessions,0),m=t.reduce((k,F)=>k+F.totalPaid,0),b=t.reduce((k,F)=>k+F.totalCustomers,0),S=h>0?b/h:0,T=u>0?m/u:0;return{totalTrainers:u,totalSessions:h,totalRevenue:m,totalCustomers:b,avgClassSize:S,avgRevenue:T}},[t]),C.useMemo(()=>{if(!t.length)return{top:[],bottom:[]};const u=t.reduce((b,S)=>(b[S.trainerName]||(b[S.trainerName]={name:S.trainerName,totalSessions:0,totalRevenue:0,totalCustomers:0,location:S.location}),b[S.trainerName].totalSessions+=S.totalSessions,b[S.trainerName].totalRevenue+=S.totalPaid,b[S.trainerName].totalCustomers+=S.totalCustomers,b),{}),m=[...Object.values(u)].sort((b,S)=>S.totalRevenue-b.totalRevenue);return{top:m.slice(0,5),bottom:m.slice(-5).reverse()}},[t]);const d=C.useMemo(()=>{if(!t.length)return[];const u=t.reduce((h,m)=>{const b=m.monthYear;return h[b]||(h[b]={month:b,sessions:0,revenue:0,customers:0}),h[b].sessions+=m.totalSessions,h[b].revenue+=m.totalPaid,h[b].customers+=m.totalCustomers,h},{});return Object.values(u).sort((h,m)=>h.month.localeCompare(m.month))},[t]);return x?e.jsx(R,{className:"bg-gradient-to-br from-white via-slate-50/30 to-white border-0 shadow-xl",children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),e.jsx("span",{className:"text-slate-600",children:"Loading trainer performance data..."})]})})}):v?e.jsx(R,{className:"bg-gradient-to-br from-red-50 to-red-100 border-red-200 shadow-xl",children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-2 text-red-700",children:[e.jsx(Ns,{className:"w-5 h-5"}),e.jsxs("span",{children:["Error loading trainer data: ",v]})]})})}):t.length?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs(R,{className:"bg-white shadow-xl border-0",children:[e.jsx(E,{children:e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-5 h-5 text-blue-600"}),"Location Performance"]})}),e.jsx(M,{children:e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:["All Locations",...Array.from(new Set(t.map(u=>u.location)))].map(u=>e.jsx("button",{onClick:()=>l(u),className:`px-4 py-2 rounded-lg font-medium transition-all duration-200 ${y===u?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:u},u))})})]}),e.jsx(Es,{data:i||[],onFiltersChange:s,isCollapsed:a,onToggleCollapse:()=>N(!a)})]}),e.jsx(Is,{data:t}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(R,{className:"bg-gradient-to-br from-white via-slate-50/30 to-white border-0 shadow-xl",children:[e.jsx(E,{children:e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-blue-600"}),"Monthly Performance Trends"]})}),e.jsx(M,{children:e.jsx(pe,{width:"100%",height:300,children:e.jsxs(We,{data:d,children:[e.jsx(we,{strokeDasharray:"3 3"}),e.jsx(Se,{dataKey:"month"}),e.jsx(Ce,{}),e.jsx(ve,{}),e.jsx(je,{type:"monotone",dataKey:"revenue",stroke:"#3B82F6",strokeWidth:3,name:"Revenue"}),e.jsx(je,{type:"monotone",dataKey:"sessions",stroke:"#10B981",strokeWidth:2,name:"Sessions"})]})})})]}),e.jsxs(R,{className:"bg-gradient-to-br from-white via-slate-50/30 to-white border-0 shadow-xl",children:[e.jsx(E,{children:e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(K,{className:"w-5 h-5 text-green-600"}),"Sessions vs Revenue"]})}),e.jsx(M,{children:e.jsx(pe,{width:"100%",height:300,children:e.jsxs(He,{data:d,children:[e.jsx(we,{strokeDasharray:"3 3"}),e.jsx(Se,{dataKey:"month"}),e.jsx(Ce,{}),e.jsx(ve,{}),e.jsx(Te,{dataKey:"sessions",fill:"#10B981",name:"Sessions"}),e.jsx(Te,{dataKey:"customers",fill:"#8B5CF6",name:"Customers"})]})})})]})]}),e.jsx(Ys,{data:t,onTrainerClick:c}),e.jsxs(Fe,{value:f,onValueChange:w,className:"space-y-4",children:[e.jsxs(Ae,{className:"grid w-full grid-cols-4 bg-white border border-gray-200 p-1 rounded-xl shadow-sm h-14",children:[e.jsxs(G,{value:"month-on-month",className:"flex items-center gap-2 px-3 py-2 rounded-lg font-semibold text-xs transition-all duration-200 data-[state=active]:bg-blue-600 data-[state=active]:text-white data-[state=active]:shadow-md hover:bg-gray-50 data-[state=active]:hover:bg-blue-700",children:[e.jsx(Pe,{className:"w-4 h-4"}),"Month-on-Month"]}),e.jsxs(G,{value:"year-on-year",className:"flex items-center gap-2 px-3 py-2 rounded-lg font-semibold text-xs transition-all duration-200 data-[state=active]:bg-emerald-600 data-[state=active]:text-white data-[state=active]:shadow-md hover:bg-gray-50 data-[state=active]:hover:bg-emerald-700",children:[e.jsx(z,{className:"w-4 h-4"}),"Year-on-Year"]}),e.jsxs(G,{value:"efficiency-analysis",className:"flex items-center gap-2 px-3 py-2 rounded-lg font-semibold text-xs transition-all duration-200 data-[state=active]:bg-orange-600 data-[state=active]:text-white data-[state=active]:shadow-md hover:bg-gray-50 data-[state=active]:hover:bg-orange-700",children:[e.jsx(W,{className:"w-4 h-4"}),"Efficiency"]}),e.jsxs(G,{value:"performance-detail",className:"flex items-center gap-2 px-3 py-2 rounded-lg font-semibold text-xs transition-all duration-200 data-[state=active]:bg-purple-600 data-[state=active]:text-white data-[state=active]:shadow-md hover:bg-gray-50 data-[state=active]:hover:bg-purple-700",children:[e.jsx(Re,{className:"w-4 h-4"}),"Performance"]})]}),e.jsxs(ee,{value:"month-on-month",className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(be,{payrollData:i||[],defaultFileName:"month-on-month-trainer-analysis",size:"sm",variant:"outline"})}),e.jsx(Ds,{data:t,defaultMetric:"totalSessions",onRowClick:c}),e.jsx(Ne,{pageId:"month-on-month-trainer",title:"Month-on-Month Analysis Notes"})]}),e.jsxs(ee,{value:"year-on-year",className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(be,{payrollData:i||[],defaultFileName:"year-on-year-trainer-analysis",size:"sm",variant:"outline"})}),e.jsx(ks,{data:t,onRowClick:c}),e.jsx(Ne,{pageId:"year-on-year-trainer",title:"Year-on-Year Analysis Notes"})]}),e.jsxs(ee,{value:"efficiency-analysis",className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(be,{payrollData:i||[],defaultFileName:"trainer-efficiency-analysis",size:"sm",variant:"outline"})}),e.jsx(As,{data:t,onRowClick:c}),e.jsx(Ne,{pageId:"efficiency-analysis-trainer",title:"Efficiency Analysis Notes"})]}),e.jsxs(ee,{value:"performance-detail",className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(be,{payrollData:i||[],defaultFileName:"trainer-performance-detail",size:"sm",variant:"outline"})}),e.jsx(Fs,{data:t,onRowClick:c}),e.jsx(Ne,{pageId:"performance-detail-trainer",title:"Performance Detail Notes"})]})]}),j&&r&&e.jsx(Vs,{isOpen:!!j,onClose:o,trainerName:j,trainerData:r})]}):e.jsx(R,{className:"bg-gradient-to-br from-white via-slate-50/30 to-white border-0 shadow-xl",children:e.jsx(M,{className:"p-6",children:e.jsx("p",{className:"text-center text-slate-600",children:"No trainer performance data available"})})})},Zs=({data:i,onDrillDown:x})=>{var c,o;const[v,f]=C.useState({type:"class",metric:"fillRate",period:"current",minSessions:3}),[w,j]=C.useState(!0),[p,r]=C.useState(!0),n=C.useMemo(()=>{if(!i||i.length===0)return[];const d=i.reduce((h,m)=>{let b="";switch(v.type){case"class":b=m.cleanedClass||"Unknown";break;case"trainer":b=m.trainerName||"Unknown";break;case"location":b=m.location||"Unknown";break;case"timeSlot":b=m.time||"Unknown";break;case"dayOfWeek":b=m.dayOfWeek||"Unknown";break;default:b="Unknown"}return h[b]||(h[b]=[]),h[b].push(m),h},{});return Object.entries(d).filter(([,h])=>h.length>=v.minSessions).map(([h,m])=>{const b=m.length,S=m.reduce((Z,ne)=>Z+(ne.checkedInCount||0),0),T=m.reduce((Z,ne)=>Z+(ne.capacity||0),0),k=m.reduce((Z,ne)=>Z+(ne.totalPaid||0),0),F=T>0?S/T*100:0,X=b>0?S/b:0,O=b>0?k/b:0,I=m.map(Z=>Z.checkedInCount||0),B=X,fe=I.reduce((Z,ne)=>Z+Math.pow(ne-B,2),0)/I.length,Me=Math.sqrt(fe),_=B>0?Math.max(0,100-Me/B*100):0,se=Math.random()*20-10;let te,ae;switch(v.metric){case"fillRate":te=F,ae=he(F);break;case"revenue":te=k,ae=V(k);break;case"attendance":te=S,ae=D(S);break;case"consistency":te=_,ae=he(_);break;case"growth":te=se,ae=`${se>0?"+":""}${se.toFixed(1)}%`;break;default:te=F,ae=he(F)}return{id:`${v.type}-${h}`,name:h,value:te,displayValue:ae,trend:se>2?"up":se<-2?"down":"neutral",change:se,rank:0,totalItems:0,details:{sessions:m,totalSessions:b,totalAttendance:S,totalCapacity:T,totalRevenue:k,fillRate:F,avgAttendance:X,avgRevenue:O,consistency:_,growth:se}}}).sort((h,m)=>m.value-h.value).map((h,m,b)=>U(L({},h),{rank:m+1,totalItems:b.length}))},[i,v]),a=C.useMemo(()=>n.slice(0,5),[n]),N=C.useMemo(()=>n.slice(-5).reverse(),[n]),y=C.useMemo(()=>n.length===0?0:n.reduce((d,u)=>d+u.value,0)/n.length,[n]),l=C.useCallback(d=>{x&&x({title:`${d.name} - Performance Analysis`,type:v.type,metric:v.metric,performanceData:d,sessions:d.details.sessions,breakdown:d.details})},[x,v]),g=d=>{switch(d){case"fillRate":return W;case"revenue":return Q;case"attendance":return q;case"consistency":return K;case"growth":return z;default:return ge}},s=d=>{switch(d){case"class":return Re;case"trainer":return Ke;case"location":return Ss;case"timeSlot":return Ue;case"dayOfWeek":return Pe;default:return ge}},t=({item:d,isTop:u=!0})=>{const h=s(v.type),m=d.value>y;return e.jsx(R,{className:P("cursor-pointer transition-all duration-300 hover:shadow-lg border",u?m?"border-green-200 bg-green-50 hover:border-green-300":"border-blue-200 bg-blue-50 hover:border-blue-300":"border-red-200 bg-red-50 hover:border-red-300",p&&d.rank<=3&&"ring-2 ring-yellow-400 ring-opacity-50"),onClick:()=>l(d),children:e.jsxs(M,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:P("p-2 rounded-lg",u?m?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700":"bg-red-100 text-red-700"),children:e.jsx(h,{className:"w-4 h-4"})}),e.jsx("div",{className:"text-sm font-medium text-slate-900 truncate",children:d.name})]}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs($,{variant:"secondary",className:P("text-xs",d.rank<=3?"bg-yellow-100 text-yellow-800 border-yellow-300":"bg-slate-100 text-slate-600"),children:["#",d.rank]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xl font-bold text-slate-900",children:d.displayValue}),w&&e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"text-slate-500",children:["vs avg: ",typeof y=="number"?he(y):y]}),e.jsxs("div",{className:P("flex items-center gap-1",d.trend==="up"?"text-green-600":d.trend==="down"?"text-red-600":"text-slate-500"),children:[d.trend==="up"?e.jsx(ys,{className:"w-3 h-3"}):d.trend==="down"?e.jsx(ws,{className:"w-3 h-3"}):null,Math.abs(d.change).toFixed(1),"%"]})]}),e.jsxs("div",{className:"text-xs text-slate-500",children:[d.details.totalSessions," sessions • ",D(d.details.totalAttendance)," attendance"]})]})]})})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(R,{className:"bg-white border-slate-200",children:[e.jsx(E,{className:"border-b border-slate-100",children:e.jsx(Y,{className:"text-lg font-semibold text-slate-900",children:"Performance Analytics Controls"})}),e.jsxs(M,{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(me,{className:"text-sm font-medium text-slate-700",children:"Analysis Type"}),e.jsxs(le,{value:v.type,onValueChange:d=>f(u=>U(L({},u),{type:d})),children:[e.jsx(oe,{children:e.jsx(ie,{})}),e.jsxs(ce,{children:[e.jsx(A,{value:"class",children:"Class Analysis"}),e.jsx(A,{value:"trainer",children:"Trainer Analysis"}),e.jsx(A,{value:"location",children:"Location Analysis"}),e.jsx(A,{value:"timeSlot",children:"Time Slot Analysis"}),e.jsx(A,{value:"dayOfWeek",children:"Day of Week Analysis"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(me,{className:"text-sm font-medium text-slate-700",children:"Metric"}),e.jsxs(le,{value:v.metric,onValueChange:d=>f(u=>U(L({},u),{metric:d})),children:[e.jsx(oe,{children:e.jsx(ie,{})}),e.jsxs(ce,{children:[e.jsx(A,{value:"fillRate",children:"Fill Rate"}),e.jsx(A,{value:"revenue",children:"Revenue"}),e.jsx(A,{value:"attendance",children:"Attendance"}),e.jsx(A,{value:"consistency",children:"Consistency"}),e.jsx(A,{value:"growth",children:"Growth"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(me,{className:"text-sm font-medium text-slate-700",children:"Period"}),e.jsxs(le,{value:v.period,onValueChange:d=>f(u=>U(L({},u),{period:d})),children:[e.jsx(oe,{children:e.jsx(ie,{})}),e.jsxs(ce,{children:[e.jsx(A,{value:"current",children:"Current Period"}),e.jsx(A,{value:"monthToMonth",children:"Month to Month"}),e.jsx(A,{value:"weekToWeek",children:"Week to Week"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(me,{className:"text-sm font-medium text-slate-700",children:"Min Sessions"}),e.jsxs(le,{value:v.minSessions.toString(),onValueChange:d=>f(u=>U(L({},u),{minSessions:parseInt(d)})),children:[e.jsx(oe,{children:e.jsx(ie,{})}),e.jsxs(ce,{children:[e.jsx(A,{value:"1",children:"1+ Sessions"}),e.jsx(A,{value:"3",children:"3+ Sessions"}),e.jsx(A,{value:"5",children:"5+ Sessions"}),e.jsx(A,{value:"10",children:"10+ Sessions"})]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ee,{id:"show-comparisons",checked:w,onCheckedChange:j}),e.jsx(me,{htmlFor:"show-comparisons",className:"text-sm text-slate-700",children:"Show Comparisons"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ee,{id:"highlight-top",checked:p,onCheckedChange:r}),e.jsx(me,{htmlFor:"highlight-top",className:"text-sm text-slate-700",children:"Highlight Top 3"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(R,{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-200",children:e.jsxs(M,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-xl",children:e.jsx(ge,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900",children:"Total Items"}),e.jsx("p",{className:"text-2xl font-bold text-blue-800",children:n.length})]})]}),e.jsxs("p",{className:"text-sm text-blue-700",children:[v.type.charAt(0).toUpperCase()+v.type.slice(1),"s being analyzed"]})]})}),e.jsx(R,{className:"bg-gradient-to-br from-green-50 to-emerald-50 border-green-200",children:e.jsxs(M,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-xl",children:ke.createElement(g(v.metric),{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-green-900",children:["Average ",v.metric]}),e.jsx("p",{className:"text-2xl font-bold text-green-800",children:typeof y=="number"?v.metric.includes("Rate")||v.metric==="consistency"?he(y):v.metric==="revenue"?V(y):D(y):y})]})]}),e.jsx("p",{className:"text-sm text-green-700",children:"Performance benchmark"})]})}),e.jsx(R,{className:"bg-gradient-to-br from-yellow-50 to-amber-50 border-yellow-200",children:e.jsxs(M,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-3 bg-yellow-100 rounded-xl",children:e.jsx(ye,{className:"w-6 h-6 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-yellow-900",children:"Top Performer"}),e.jsx("p",{className:"text-lg font-bold text-yellow-800 truncate",children:((c=a[0])==null?void 0:c.name)||"N/A"})]})]}),e.jsx("p",{className:"text-sm text-yellow-700",children:((o=a[0])==null?void 0:o.displayValue)||"No data"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(R,{className:"bg-white border-slate-200",children:[e.jsx(E,{className:"border-b border-slate-100",children:e.jsxs(Y,{className:"flex items-center gap-2 text-green-700",children:[e.jsx(z,{className:"w-5 h-5"}),"Top Performers"]})}),e.jsxs(M,{className:"p-4 space-y-3",children:[a.map(d=>e.jsx(t,{item:d,isTop:!0},d.id)),a.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-500",children:"No data available for current filters"})]})]}),e.jsxs(R,{className:"bg-white border-slate-200",children:[e.jsx(E,{className:"border-b border-slate-100",children:e.jsxs(Y,{className:"flex items-center gap-2 text-red-700",children:[e.jsx(J,{className:"w-5 h-5"}),"Improvement Opportunities"]})}),e.jsxs(M,{className:"p-4 space-y-3",children:[N.map(d=>e.jsx(t,{item:d,isTop:!1},d.id)),N.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-500",children:"No data available for current filters"})]})]})]})]})};export{Js as C,Xs as E,Zs as I,Ws as P};
