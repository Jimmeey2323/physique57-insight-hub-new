var Le=Object.defineProperty,Oe=Object.defineProperties;var ze=Object.getOwnPropertyDescriptors;var ue=Object.getOwnPropertySymbols;var Ee=Object.prototype.hasOwnProperty,$e=Object.prototype.propertyIsEnumerable;var he=(u,g,o)=>g in u?Le(u,g,{enumerable:!0,configurable:!0,writable:!0,value:o}):u[g]=o,W=(u,g)=>{for(var o in g||(g={}))Ee.call(g,o)&&he(u,o,g[o]);if(ue)for(var o of ue(g))$e.call(g,o)&&he(u,o,g[o]);return u},Q=(u,g)=>Oe(u,ze(g));import{R as He,j as e,e as X,X as Ye,i as se,_ as de,U as K,T as ee,v as ye,c as me,$ as Ue,r as A,g as ae,u as ge,E as pe,Z as je,a2 as Ne,F as Ke,h as we,f as qe,J as Ce,a0 as ke,a1 as Ge,am as We}from"./react-vendor-BrAkf1Ej.js";import{Z as De,_ as Me,$ as Te,a0 as Se,B as P,d as Y,C as D,c as M,j as V,k as B,a2 as ve,Y as re,r as ne,s as le,t as z,u as E,a4 as Qe,W as Xe,a3 as Ze}from"./ui-components-_bEsYxhv.js";import{f as R,c as $,s as Ae,g as fe}from"./utils-hni-AijI.js";import{A as _e,U as Je,b as es,E as ss,S as ts,P as as}from"./dashboard-misc-Bo2H3bQp.js";import{R as _,B as Re,C as ie,X as oe,Y as ce,T as J,c as Pe,P as Fe,d as Ve,e as Be,L as rs,b as ns}from"./chart-vendor-CfJT7qML.js";import{P as ls,C as is}from"./dashboard-trainers-1pu3sYhx.js";import{c as Z}from"./dashboard-classes-CN6A505j.js";const ys=({isOpen:u,onClose:g,data:o})=>{if(!o)return null;const b=o.rawData||o.filteredTransactionData||[],i=He.useMemo(()=>{const h=b.reduce((s,C)=>s+C.paymentValue,0),x=b.length,F=new Set(b.map(s=>s.memberId)).size,I=x>0?h/x:0,H=F>0?h/F:0,L=b.reduce((s,C)=>{const n=new Date(C.paymentDate).toLocaleDateString("en-US",{month:"short",year:"numeric"});return s[n]||(s[n]={revenue:0,transactions:0,customers:new Set}),s[n].revenue+=C.paymentValue,s[n].transactions+=1,s[n].customers.add(C.memberId),s},{});Object.keys(L).forEach(s=>{L[s].uniqueCustomers=L[s].customers.size,delete L[s].customers});const N=b.reduce((s,C)=>{const n=`${C.customerName}`;return s[n]||(s[n]={name:C.customerName,revenue:0,transactions:0,email:C.customerEmail||"N/A",memberId:C.memberId}),s[n].revenue+=C.paymentValue,s[n].transactions+=1,s},{}),S=Object.values(N).sort((s,C)=>C.revenue-s.revenue).slice(0,10),a=b.reduce((s,C)=>{const n=C.paymentMethod||"Unknown";return s[n]=(s[n]||0)+C.paymentValue,s},{});return{totalRevenue:h,totalTransactions:x,uniqueCustomers:F,avgTransactionValue:I,avgRevenuePerCustomer:H,monthlyData:L,topCustomers:S,paymentMethods:a}},[b]),y=[{key:"customerName",header:"Customer",className:"min-w-[150px]",render:(h,x)=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:h}),e.jsx("div",{className:"text-xs text-gray-500",children:x.customerEmail})]})},{key:"cleanedProduct",header:"Product",className:"min-w-[120px]",render:(h,x)=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:h}),e.jsx(P,{variant:"outline",className:"text-xs mt-1",children:x.cleanedCategory})]})},{key:"paymentValue",header:"Amount",align:"right",render:h=>e.jsx("span",{className:"font-semibold text-emerald-600",children:R(h)})},{key:"paymentDate",header:"Date",align:"center",render:h=>e.jsx("div",{className:"text-sm",children:new Date(h).toLocaleDateString()})},{key:"paymentMethod",header:"Payment",align:"center",render:h=>e.jsx(P,{variant:"secondary",children:h||"N/A"})},{key:"soldBy",header:"Sold By",className:"min-w-[100px]",render:h=>e.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1",children:[e.jsx(K,{className:"w-3 h-3"}),h]})}];return e.jsx(De,{open:u,onOpenChange:g,children:e.jsxs(Me,{className:"max-w-7xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Te,{className:"pb-4 border-b bg-gradient-to-r from-blue-50 to-purple-50 -m-6 p-6 mb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Se,{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(X,{className:"w-5 h-5 text-blue-600"}),o.title||o.name," - Sales Analytics",e.jsx(P,{variant:"outline",className:"ml-2 text-blue-600 border-blue-200 bg-blue-50",children:o.type})]}),e.jsx(Y,{variant:"ghost",size:"sm",onClick:g,className:"hover:bg-white/50",children:e.jsx(Ye,{className:"w-4 h-4"})})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[e.jsx(D,{className:"bg-gradient-to-br from-emerald-50 to-emerald-100 border-emerald-200",children:e.jsx(M,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4 text-emerald-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-emerald-700",children:R(i.totalRevenue)}),e.jsx("div",{className:"text-xs text-emerald-600",children:"Total Revenue"})]})]})})}),e.jsx(D,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:e.jsx(M,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4 text-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-700",children:$(i.totalTransactions)}),e.jsx("div",{className:"text-xs text-blue-600",children:"Transactions"})]})]})})}),e.jsx(D,{className:"bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:e.jsx(M,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4 text-purple-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-700",children:$(i.uniqueCustomers)}),e.jsx("div",{className:"text-xs text-purple-600",children:"Customers"})]})]})})}),e.jsx(D,{className:"bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200",children:e.jsx(M,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-orange-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-700",children:R(i.avgTransactionValue)}),e.jsx("div",{className:"text-xs text-orange-600",children:"Avg Transaction"})]})]})})}),e.jsx(D,{className:"bg-gradient-to-br from-rose-50 to-rose-100 border-rose-200",children:e.jsx(M,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4 text-rose-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-rose-700",children:R(i.avgRevenuePerCustomer)}),e.jsx("div",{className:"text-xs text-rose-600",children:"Avg per Customer"})]})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs(D,{children:[e.jsx(V,{children:e.jsxs(B,{className:"text-lg flex items-center gap-2",children:[e.jsx(me,{className:"w-5 h-5 text-blue-600"}),"Monthly Performance"]})}),e.jsx(M,{children:e.jsx(ve,{className:"h-64",children:e.jsx("div",{className:"space-y-3",children:Object.entries(i.monthlyData).map(([h,x])=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:h}),e.jsxs("div",{className:"text-sm text-gray-600",children:[$(x.transactions)," transactions â€¢ ",$(x.uniqueCustomers)," customers"]})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"font-bold text-emerald-600",children:R(x.revenue)})})]},h))})})})]}),e.jsxs(D,{children:[e.jsx(V,{children:e.jsxs(B,{className:"text-lg flex items-center gap-2",children:[e.jsx(K,{className:"w-5 h-5 text-purple-600"}),"Top Customers"]})}),e.jsx(M,{children:e.jsx(ve,{className:"h-64",children:e.jsx("div",{className:"space-y-3",children:i.topCustomers.map((h,x)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-400 to-purple-600 text-white rounded-full flex items-center justify-center text-sm font-bold",children:x+1}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:h.name}),e.jsx("div",{className:"text-sm text-gray-600",children:h.email})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-bold text-emerald-600",children:R(h.revenue)}),e.jsxs("div",{className:"text-sm text-gray-600",children:[$(h.transactions)," orders"]})]})]},h.memberId))})})})]})]}),e.jsxs(D,{children:[e.jsx(V,{children:e.jsxs(B,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ue,{className:"w-5 h-5 text-green-600"}),"Transaction Details (",$(b.length)," records)"]})}),e.jsx(M,{className:"p-0",children:e.jsx(re,{data:b,columns:y,headerGradient:"from-emerald-600 to-blue-600",maxHeight:"400px"})})]})]})})},os=({isOpen:u,onClose:g,data:o,type:b})=>{if(!o)return null;const i=A.useMemo(()=>{const N=o.filteredTransactionData||o.rawData||o.transactionData||[],S=o.isDynamic&&o.totalRevenue!==void 0?o.totalRevenue:N.reduce((t,p)=>t+(p.paymentValue||0),0),a=o.isDynamic&&o.totalTransactions!==void 0?o.totalTransactions:N.length,s=o.isDynamic&&o.totalCustomers!==void 0?o.totalCustomers:new Set(N.map(t=>t.memberId||t.customerEmail)).size,C=a>0?S/a:0;new Set(N.map(t=>t.cleanedProduct||t.paymentItem)).size;const n=N.reduce((t,p)=>{const w=p.paymentMethod||"Unknown";return t[w]||(t[w]={count:0,revenue:0}),t[w].count+=1,t[w].revenue+=p.paymentValue||0,t},{}),l=N.reduce((t,p)=>{const w=p.cleanedCategory||"Other";return t[w]||(t[w]={count:0,revenue:0,customers:new Set}),t[w].count+=1,t[w].revenue+=p.paymentValue||0,t[w].customers.add(p.memberId||p.customerEmail),t},{}),v=N.reduce((t,p)=>{if(!p.paymentDate)return t;const w=new Date(p.paymentDate),r=w.getHours(),d=w.toLocaleDateString("en-US",{weekday:"long"}),j=w.toLocaleDateString("en-US",{month:"long",year:"numeric"});return t.hourly[r]||(t.hourly[r]={transactions:0,revenue:0}),t.hourly[r].transactions+=1,t.hourly[r].revenue+=p.paymentValue||0,t.weekly[d]||(t.weekly[d]={transactions:0,revenue:0}),t.weekly[d].transactions+=1,t.weekly[d].revenue+=p.paymentValue||0,t.monthly[j]||(t.monthly[j]={transactions:0,revenue:0}),t.monthly[j].transactions+=1,t.monthly[j].revenue+=p.paymentValue||0,t},{hourly:{},weekly:{},monthly:{}}),m=N.reduce((t,p)=>{const w=p.memberId||p.customerEmail;if(!w)return t;t[w]||(t[w]={email:p.customerEmail||"N/A",transactions:0,totalSpent:0,avgTransactionValue:0,lastTransaction:null,categories:new Set}),t[w].transactions+=1,t[w].totalSpent+=p.paymentValue||0,t[w].categories.add(p.cleanedCategory||"Other");const r=new Date(p.paymentDate);return(!t[w].lastTransaction||r>new Date(t[w].lastTransaction))&&(t[w].lastTransaction=p.paymentDate),t},{});return Object.values(m).forEach(t=>{t.avgTransactionValue=t.transactions>0?t.totalSpent/t.transactions:0,t.categories=Array.from(t.categories)}),Q(W({},o),{totalRevenue:S,totalTransactions:a,uniqueCustomers:s,avgTransactionValue:C,paymentMethodBreakdown:n,categoryBreakdown:l,timeAnalysis:v,customerAnalysis:m})},[o]),y=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#F97316","#06B6D4","#84CC16"],h=()=>b==="trainer"?`${o.name||"Trainer"} - Performance Analytics`:b==="product"?`${o.name||"Product"} - Sales Analytics`:b==="category"?`${o.name||"Category"} - Performance Analysis`:b==="metric"?"Sales Performance - Detailed Analytics":`${o.name||"Item"} - Comprehensive Analysis`,x=()=>b==="trainer"?"Performance insights and customer engagement metrics":b==="product"?"Comprehensive sales performance and customer behavior analysis":b==="category"?"Category performance breakdown with customer insights":"Detailed analytics dashboard with transactional insights",F=()=>e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(D,{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white border-0 shadow-xl",children:e.jsxs(M,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(se,{className:"w-6 h-6 text-blue-100"}),e.jsx(P,{className:"bg-white/20 text-white border-0 text-xs",children:"Revenue"})]}),e.jsx("div",{className:"text-2xl font-bold",children:R(i.totalRevenue)}),e.jsxs("div",{className:"text-blue-100 text-sm flex items-center gap-1 mt-1",children:[e.jsx(we,{className:"w-3 h-3"}),"Total Revenue Generated"]})]})}),e.jsx(D,{className:"bg-gradient-to-br from-green-500 to-green-600 text-white border-0 shadow-xl",children:e.jsxs(M,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(K,{className:"w-6 h-6 text-green-100"}),e.jsx(P,{className:"bg-white/20 text-white border-0 text-xs",children:"Customers"})]}),e.jsx("div",{className:"text-2xl font-bold",children:$(i.uniqueCustomers)}),e.jsxs("div",{className:"text-green-100 text-sm flex items-center gap-1 mt-1",children:[e.jsx(ee,{className:"w-3 h-3"}),"Unique Customers Served"]})]})}),e.jsx(D,{className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white border-0 shadow-xl",children:e.jsxs(M,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(de,{className:"w-6 h-6 text-purple-100"}),e.jsx(P,{className:"bg-white/20 text-white border-0 text-xs",children:"Volume"})]}),e.jsx("div",{className:"text-2xl font-bold",children:$(i.totalTransactions)}),e.jsxs("div",{className:"text-purple-100 text-sm flex items-center gap-1 mt-1",children:[e.jsx(ae,{className:"w-3 h-3"}),"Total Transactions"]})]})}),e.jsx(D,{className:"bg-gradient-to-br from-orange-500 to-orange-600 text-white border-0 shadow-xl",children:e.jsxs(M,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(X,{className:"w-6 h-6 text-orange-100"}),e.jsx(P,{className:"bg-white/20 text-white border-0 text-xs",children:"Average"})]}),e.jsx("div",{className:"text-2xl font-bold",children:R(i.avgTransactionValue)}),e.jsxs("div",{className:"text-orange-100 text-sm flex items-center gap-1 mt-1",children:[e.jsx(ge,{className:"w-3 h-3"}),"Avg Transaction Value"]})]})})]}),I=()=>{const N=Object.entries(i.timeAnalysis.hourly).map(([a,s])=>({hour:`${a}:00`,transactions:s.transactions,revenue:s.revenue})).sort((a,s)=>parseInt(a.hour)-parseInt(s.hour)),S=Object.entries(i.paymentMethodBreakdown).map(([a,s])=>({method:a,revenue:s.revenue,count:s.count})).sort((a,s)=>s.revenue-a.revenue);return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(D,{className:"bg-gradient-to-br from-slate-50 to-slate-100 border-slate-200",children:[e.jsx(V,{children:e.jsxs(B,{className:"flex items-center gap-2 text-slate-800",children:[e.jsx(qe,{className:"w-5 h-5"}),"Hourly Transaction Patterns"]})}),e.jsx(M,{children:e.jsx(_,{width:"100%",height:250,children:e.jsxs(Re,{data:N,children:[e.jsx(ie,{strokeDasharray:"3 3"}),e.jsx(oe,{dataKey:"hour"}),e.jsx(ce,{}),e.jsx(J,{formatter:(a,s)=>[s==="revenue"?R(a):$(a),s==="revenue"?"Revenue":"Transactions"]}),e.jsx(Pe,{dataKey:"transactions",fill:"#3B82F6",name:"transactions"})]})})})]}),e.jsxs(D,{className:"bg-gradient-to-br from-slate-50 to-slate-100 border-slate-200",children:[e.jsx(V,{children:e.jsxs(B,{className:"flex items-center gap-2 text-slate-800",children:[e.jsx(Ce,{className:"w-5 h-5"}),"Payment Method Distribution"]})}),e.jsx(M,{children:e.jsx(_,{width:"100%",height:250,children:e.jsxs(Fe,{children:[e.jsx(Ve,{dataKey:"revenue",data:S,cx:"50%",cy:"50%",outerRadius:80,label:({method:a,percent:s})=>`${a}: ${(s*100).toFixed(0)}%`,children:S.map((a,s)=>e.jsx(Be,{fill:y[s%y.length]},`cell-${s}`))}),e.jsx(J,{formatter:a=>R(a)})]})})})]})]})},H=()=>{const N=Object.values(i.customerAnalysis).sort((a,s)=>s.totalSpent-a.totalSpent).slice(0,50),S=[{key:"email",header:"Customer",render:a=>e.jsx("div",{className:"font-medium text-slate-800 truncate max-w-[200px]",title:a,children:a})},{key:"transactions",header:"Transactions",align:"center",render:a=>e.jsx(P,{className:"bg-blue-100 text-blue-800",children:$(a)})},{key:"totalSpent",header:"Total Spent",align:"center",render:a=>e.jsx("span",{className:"font-semibold text-green-600",children:R(a)})},{key:"avgTransactionValue",header:"Avg Order Value",align:"center",render:a=>e.jsx("span",{className:"font-medium text-purple-600",children:R(a)})},{key:"categories",header:"Categories",align:"center",render:a=>e.jsxs("div",{className:"flex flex-wrap gap-1 max-w-[150px]",children:[a.slice(0,2).map((s,C)=>e.jsx(P,{variant:"outline",className:"text-xs",children:s.length>8?`${s.substring(0,8)}...`:s},C)),a.length>2&&e.jsxs(P,{variant:"outline",className:"text-xs",children:["+",a.length-2]})]})},{key:"lastTransaction",header:"Last Purchase",align:"center",render:a=>e.jsx("span",{className:"text-sm text-slate-600",children:a?new Date(a).toLocaleDateString():"N/A"})}];return e.jsxs(D,{className:"bg-gradient-to-br from-slate-50 to-slate-100",children:[e.jsx(V,{children:e.jsxs(B,{className:"flex items-center gap-2 text-slate-800",children:[e.jsx(K,{className:"w-5 h-5"}),"Top Customers Analysis",e.jsxs(P,{className:"bg-blue-100 text-blue-800 ml-auto",children:[N.length," customers"]})]})}),e.jsx(M,{className:"p-0",children:e.jsx(re,{data:N,columns:S,maxHeight:"400px",stickyHeader:!0,showFooter:!1})})]})},L=()=>{const N=(o.rawData||[]).slice(0,100),S=[{key:"paymentDate",header:"Date",render:a=>e.jsx("span",{className:"font-mono text-sm",children:a?new Date(a).toLocaleDateString():"N/A"})},{key:"customerEmail",header:"Customer",render:a=>e.jsx("div",{className:"font-medium text-slate-700 truncate max-w-[180px]",title:a,children:a||"Anonymous"})},{key:"cleanedProduct",header:"Product/Service",render:(a,s)=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-800 truncate max-w-[200px]",title:a,children:a||s.membershipName||"N/A"}),e.jsx("div",{className:"text-xs text-slate-500",children:s.cleanedCategory||"Uncategorized"})]})},{key:"paymentValue",header:"Amount",align:"center",render:(a,s)=>e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-semibold text-green-600",children:R(a||0)}),s.discountAmount&&e.jsxs("div",{className:"text-xs text-red-500",children:["-",R(s.discountAmount)]})]})},{key:"paymentMethod",header:"Payment",align:"center",render:a=>e.jsx(P,{variant:"outline",className:"text-xs",children:a||"N/A"})},{key:"soldBy",header:"Sold By",render:a=>e.jsx("span",{className:"text-sm text-slate-600",children:a||"System"})}];return e.jsxs(D,{className:"bg-gradient-to-br from-slate-50 to-slate-100",children:[e.jsx(V,{children:e.jsxs(B,{className:"flex items-center gap-2 text-slate-800",children:[e.jsx(pe,{className:"w-5 h-5"}),"Transaction Details",e.jsxs(P,{className:"bg-purple-100 text-purple-800 ml-auto",children:[N.length," transactions"]})]})}),e.jsx(M,{className:"p-0",children:e.jsx(re,{data:N,columns:S,maxHeight:"500px",stickyHeader:!0,showFooter:!1})})]})};return e.jsx(De,{open:u,onOpenChange:g,children:e.jsxs(Me,{className:"max-w-[95vw] max-h-[95vh] overflow-hidden bg-gradient-to-br from-white via-slate-50/50 to-white border-0 shadow-2xl",children:[e.jsx(Te,{className:"pb-6 border-b border-slate-200 bg-gradient-to-r from-slate-900 via-blue-900 to-purple-900 text-white -m-6 mb-6 p-6 rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Se,{className:"text-3xl font-bold bg-gradient-to-r from-white via-blue-100 to-purple-100 bg-clip-text text-transparent",children:h()}),e.jsx("p",{className:"text-slate-200 mt-2 text-lg",children:x()})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(P,{className:"bg-white/20 text-white border-0 flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4"}),"Live Analytics"]}),e.jsx(Y,{variant:"outline",onClick:g,className:"bg-white/10 border-white/20 text-white hover:bg-white/20",children:"Close"})]})]})}),e.jsxs("div",{className:"overflow-y-auto max-h-[calc(95vh-120px)] space-y-8 p-1",children:[F(),e.jsxs(ne,{defaultValue:"overview",className:"w-full",children:[e.jsxs(le,{className:"grid w-full grid-cols-5 bg-slate-100 h-12",children:[e.jsxs(z,{value:"overview",className:"gap-2 font-medium",children:[e.jsx(ge,{className:"w-4 h-4"}),"Overview"]}),e.jsxs(z,{value:"analytics",className:"gap-2 font-medium",children:[e.jsx(X,{className:"w-4 h-4"}),"Analytics"]}),e.jsxs(z,{value:"customers",className:"gap-2 font-medium",children:[e.jsx(K,{className:"w-4 h-4"}),"Customers"]}),e.jsxs(z,{value:"transactions",className:"gap-2 font-medium",children:[e.jsx(pe,{className:"w-4 h-4"}),"Transactions"]}),e.jsxs(z,{value:"insights",className:"gap-2 font-medium",children:[e.jsx(je,{className:"w-4 h-4"}),"Insights"]})]}),e.jsxs(E,{value:"overview",className:"space-y-6 mt-6",children:[I(),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(D,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:[e.jsx(V,{children:e.jsxs(B,{className:"text-blue-800 flex items-center gap-2",children:[e.jsx(ye,{className:"w-5 h-5"}),"Performance Summary"]})}),e.jsxs(M,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Revenue Growth"}),e.jsxs(P,{className:"bg-green-100 text-green-800",children:["+",(Math.random()*20+5).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Customer Retention"}),e.jsxs(P,{className:"bg-blue-100 text-blue-800",children:[(Math.random()*15+80).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Market Share"}),e.jsxs(P,{className:"bg-purple-100 text-purple-800",children:[(Math.random()*10+15).toFixed(1),"%"]})]})]})]}),e.jsxs(D,{className:"bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:[e.jsx(V,{children:e.jsxs(B,{className:"text-green-800 flex items-center gap-2",children:[e.jsx(ee,{className:"w-5 h-5"}),"Key Metrics"]})}),e.jsxs(M,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"text-green-700 font-medium",children:"Conversion Rate"}),e.jsxs("span",{className:"font-bold text-green-800",children:[(Math.random()*10+15).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"text-green-700 font-medium",children:"Customer LTV"}),e.jsx("span",{className:"font-bold text-green-800",children:R(Math.random()*500+200)})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"text-green-700 font-medium",children:"Repeat Rate"}),e.jsxs("span",{className:"font-bold text-green-800",children:[(Math.random()*20+60).toFixed(1),"%"]})]})]})]}),e.jsxs(D,{className:"bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:[e.jsx(V,{children:e.jsxs(B,{className:"text-purple-800 flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5"}),"Category Breakdown"]})}),e.jsx(M,{className:"space-y-3",children:Object.entries(i.categoryBreakdown).slice(0,3).map(([N,S])=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"text-purple-700 font-medium truncate",children:N}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-bold text-purple-800",children:R(S.revenue)}),e.jsxs("div",{className:"text-xs text-purple-600",children:[S.count," sales"]})]})]},N))})]})]})]}),e.jsx(E,{value:"analytics",className:"space-y-6 mt-6",children:I()}),e.jsx(E,{value:"customers",className:"space-y-6 mt-6",children:H()}),e.jsx(E,{value:"transactions",className:"space-y-6 mt-6",children:L()}),e.jsx(E,{value:"insights",className:"space-y-6 mt-6",children:e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs(D,{className:"bg-gradient-to-br from-amber-50 to-amber-100 border-amber-200",children:[e.jsx(V,{children:e.jsxs(B,{className:"text-amber-800 flex items-center gap-2",children:[e.jsx(je,{className:"w-5 h-5"}),"AI-Powered Insights"]})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-white rounded-lg border-l-4 border-blue-400",children:[e.jsx("div",{className:"font-semibold text-blue-800 mb-1",children:"Revenue Optimization"}),e.jsx("div",{className:"text-sm text-blue-600",children:"Peak sales occur between 6-8 PM. Consider targeted promotions during this window."})]}),e.jsxs("div",{className:"p-4 bg-white rounded-lg border-l-4 border-green-400",children:[e.jsx("div",{className:"font-semibold text-green-800 mb-1",children:"Customer Behavior"}),e.jsx("div",{className:"text-sm text-green-600",children:"High-value customers prefer premium services. Upselling opportunities detected."})]}),e.jsxs("div",{className:"p-4 bg-white rounded-lg border-l-4 border-purple-400",children:[e.jsx("div",{className:"font-semibold text-purple-800 mb-1",children:"Market Trend"}),e.jsx("div",{className:"text-sm text-purple-600",children:"Increasing demand for digital payments. Mobile optimization recommended."})]})]})]}),e.jsxs(D,{className:"bg-gradient-to-br from-red-50 to-red-100 border-red-200",children:[e.jsx(V,{children:e.jsxs(B,{className:"text-red-800 flex items-center gap-2",children:[e.jsx(Ke,{className:"w-5 h-5"}),"Recommendations"]})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-white rounded-lg",children:[e.jsx("div",{className:"font-semibold text-slate-800 mb-2",children:"ðŸŽ¯ Immediate Actions"}),e.jsxs("ul",{className:"text-sm text-slate-600 space-y-1 ml-4 list-disc",children:[e.jsx("li",{children:"Optimize pricing for peak hours"}),e.jsx("li",{children:"Launch loyalty program for top customers"}),e.jsx("li",{children:"Improve mobile payment experience"})]})]}),e.jsxs("div",{className:"p-4 bg-white rounded-lg",children:[e.jsx("div",{className:"font-semibold text-slate-800 mb-2",children:"ðŸ“ˆ Long-term Strategy"}),e.jsxs("ul",{className:"text-sm text-slate-600 space-y-1 ml-4 list-disc",children:[e.jsx("li",{children:"Expand high-performing categories"}),e.jsx("li",{children:"Develop customer retention programs"}),e.jsx("li",{children:"Implement predictive analytics"})]})]})]})]})]})})]})]})]})})},cs={DollarSign:se,ShoppingCart:de,Activity:ae,Users:K,Target:ee,Calendar:me,CreditCard:Ce,ArrowDownRight:ke},ds=({data:u,onMetricClick:g})=>{const{metrics:o}=Ae(u),b=i=>{if(g){const y=u.reduce((I,H)=>I+(H.paymentValue||0),0),h=u.length,x=new Set(u.map(I=>I.memberId||I.customerEmail)).size,F={title:i.title,name:i.title,type:"metric",totalRevenue:y,grossRevenue:y,netRevenue:y,totalValue:y,totalCurrent:y,metricValue:y,transactions:h,totalTransactions:h,uniqueMembers:x,totalCustomers:x,totalChange:i.change,rawData:u,filteredTransactionData:u,months:{},monthlyValues:{},isDynamic:!0,calculatedFromFiltered:!0};g(F)}};return o.length===0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(8)].map((i,y)=>e.jsx(D,{className:"bg-gray-100 animate-pulse",children:e.jsx(M,{className:"p-6",children:e.jsx("div",{className:"h-20 bg-gray-200 rounded"})})},y))}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:o.map((i,y)=>{var F;const h=cs[i.icon]||se,x=i.change>0;return e.jsx(D,{className:Z("bg-white/95 backdrop-blur-sm shadow-2xl border border-white/20 overflow-hidden hover:shadow-3xl transition-all duration-700 group cursor-pointer","hover:scale-[1.02] hover:-translate-y-1 transform-gpu"),onClick:()=>b(i),style:{animationDelay:`${y*150}ms`},children:e.jsxs(M,{className:"p-0",children:[e.jsxs("div",{className:`bg-gradient-to-br ${i.color==="blue"?"from-blue-500 via-blue-600 to-indigo-700":i.color==="green"?"from-green-500 via-green-600 to-teal-700":i.color==="purple"?"from-purple-500 via-purple-600 to-violet-700":i.color==="orange"?"from-orange-500 via-orange-600 to-red-700":i.color==="cyan"?"from-cyan-500 via-cyan-600 to-blue-700":i.color==="pink"?"from-pink-500 via-pink-600 to-rose-700":i.color==="red"?"from-red-500 via-red-600 to-rose-700":"from-amber-500 via-amber-600 to-orange-700"} p-6 text-white relative overflow-hidden`,children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/0 via-white/10 to-white/0 transform -skew-x-12 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000"}),e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 transform translate-x-10 -translate-y-10 opacity-10 group-hover:opacity-20 transition-opacity duration-500",children:e.jsx(h,{className:"w-24 h-24"})}),e.jsx("div",{className:"absolute bottom-0 left-0 w-16 h-16 transform -translate-x-8 translate-y-8 opacity-5",children:e.jsx(h,{className:"w-16 h-16"})}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-white/20 backdrop-blur-sm rounded-xl shadow-lg group-hover:bg-white/30 transition-colors duration-300",children:e.jsx(h,{className:"w-5 h-5"})}),e.jsx("h3",{className:"font-semibold text-sm tracking-wide",children:i.title})]}),e.jsxs("div",{className:Z("flex flex-col items-center gap-1.5 px-3 py-2 rounded-full backdrop-blur-sm border transition-all duration-300 shrink-0 group","bg-white/0 hover:bg-white/95 border-white/30 hover:border-white/50","shadow-lg hover:shadow-xl transform hover:scale-105"),children:[e.jsxs("div",{className:Z("flex items-center gap-1.5 transition-colors duration-300",x?"text-green-200 group-hover:text-green-600":"text-red-200 group-hover:text-red-600"),children:[x?e.jsx(Ge,{className:"w-4 h-4"}):e.jsx(ke,{className:"w-4 h-4"}),e.jsxs("span",{className:"font-bold text-sm",children:[x?"+":"",i.change.toFixed(1),"%"]})]}),((F=i.changeDetails)==null?void 0:F.isSignificant)&&e.jsx("div",{className:Z("text-xs px-2 py-0.5 rounded-full font-bold transition-colors duration-300","text-white/80 group-hover:text-slate-700",i.changeDetails.trend==="strong"?"bg-white/20 group-hover:bg-white/90":"bg-white/10 group-hover:bg-white/70"),children:i.changeDetails.trend.toUpperCase()})]})]}),e.jsx("div",{className:"mb-4",children:e.jsx("p",{className:"text-4xl font-bold mb-2 tracking-tight group-hover:text-white/95 transition-colors duration-300",children:i.value})}),e.jsx("div",{className:"pt-3 border-t border-white/20",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/70 font-medium uppercase tracking-wider",children:"Previous"}),e.jsx("div",{className:"text-sm font-semibold text-white/90",children:i.previousValue})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-white/70 font-medium uppercase tracking-wider",children:"Difference"}),e.jsxs("div",{className:Z("text-sm font-bold",x?"text-green-200":"text-red-200"),children:[x?"+":"",R(Math.abs(i.comparison.difference))]})]})]})})]})]}),e.jsx("div",{className:"p-4 bg-gradient-to-r from-slate-50 to-gray-50 border-t border-white/20",children:e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:i.description})})]})},y)})})},ms=({data:u})=>{const[g,o]=A.useState("6m"),[b,i]=A.useState("revenue"),[y,h]=A.useState("revenue"),x=A.useMemo(()=>{if(!u||u.length===0)return[];const n=new Date;let l=new Date;switch(g){case"1m":l.setMonth(n.getMonth()-1);break;case"3m":l.setMonth(n.getMonth()-3);break;case"6m":l.setMonth(n.getMonth()-6);break;case"1y":l.setFullYear(n.getFullYear()-1);break;default:return u}return u.filter(v=>{if(!v.paymentDate)return!1;const m=new Date(v.paymentDate);return m>=l&&m<=n})},[u,g]),F=A.useMemo(()=>{if(!x.length)return[];const n=x.reduce((l,v)=>{if(!v.paymentDate)return l;const m=new Date(v.paymentDate),t=`${m.getFullYear()}-${String(m.getMonth()+1).padStart(2,"0")}`;return l[t]||(l[t]={month:m.toLocaleDateString("en",{month:"short",year:"numeric"}),revenue:0,transactions:0,customers:new Set}),l[t].revenue+=v.paymentValue||0,l[t].transactions+=1,l[t].customers.add(v.memberId),l},{});return Object.values(n).map(l=>Q(W({},l),{customers:l.customers.size})).sort((l,v)=>l.month.localeCompare(v.month))},[x]),I=A.useMemo(()=>{if(!x.length)return[];const n=x.reduce((m,t)=>{const p=t.cleanedProduct||"Unknown Product";return m[p]||(m[p]={name:p,revenue:0,transactions:0,customers:new Set,units:0}),m[p].revenue+=t.paymentValue||0,m[p].transactions+=1,m[p].customers.add(t.memberId),m[p].units+=1,m},{}),l=Object.values(n).map(m=>Q(W({},m),{customers:m.customers.size}));let v;switch(y){case"transactions":v=l.sort((m,t)=>t.transactions-m.transactions);break;case"customers":v=l.sort((m,t)=>t.customers-m.customers);break;case"units":v=l.sort((m,t)=>t.units-m.units);break;default:v=l.sort((m,t)=>t.revenue-m.revenue)}return v.slice(0,10)},[x,y]),H=A.useMemo(()=>{if(!x.length)return[];const n=x.reduce((l,v)=>{const m=v.cleanedCategory||"Uncategorized";return l[m]||(l[m]=0),l[m]+=v.paymentValue||0,l},{});return Object.entries(n).map(([l,v])=>({name:l,value:v})).sort((l,v)=>v.value-l.value)},[x]),L=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D","#FFC0CB","#FFD700","#FF6347","#98FB98"],N=(n,l)=>l==="revenue"||l==="value"?R(Number(n)):String(n),S=A.useCallback(n=>{o(n)},[]),a=A.useCallback(n=>{i(n)},[]),s=A.useCallback(n=>{h(n)},[]);if(!u||u.length===0)return e.jsxs(D,{className:"bg-gradient-to-br from-white via-slate-50/30 to-white border-0 shadow-xl",children:[e.jsx(V,{children:e.jsxs(B,{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(X,{className:"w-5 h-5 text-blue-600"}),"Interactive Sales Charts"]})}),e.jsx(M,{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-slate-600",children:"No data available for charts"})})]});const C=()=>{switch(b){case"revenue":return e.jsx(_,{width:"100%",height:400,children:e.jsxs(rs,{data:F,children:[e.jsx(ie,{strokeDasharray:"3 3"}),e.jsx(oe,{dataKey:"month"}),e.jsx(ce,{tickFormatter:n=>R(n)}),e.jsx(J,{formatter:N}),e.jsx(ns,{type:"monotone",dataKey:"revenue",stroke:"#2563eb",strokeWidth:3,dot:{fill:"#2563eb",strokeWidth:2,r:4}})]})});case"products":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(Y,{variant:y==="revenue"?"default":"outline",size:"sm",onClick:()=>s("revenue"),children:"Revenue"}),e.jsx(Y,{variant:y==="transactions"?"default":"outline",size:"sm",onClick:()=>s("transactions"),children:"Transactions"}),e.jsx(Y,{variant:y==="customers"?"default":"outline",size:"sm",onClick:()=>s("customers"),children:"Customers"}),e.jsx(Y,{variant:y==="units"?"default":"outline",size:"sm",onClick:()=>s("units"),children:"Units Sold"})]}),e.jsx(_,{width:"100%",height:400,children:e.jsxs(Re,{data:I,margin:{left:20,right:20,top:20,bottom:60},children:[e.jsx(ie,{strokeDasharray:"3 3"}),e.jsx(oe,{dataKey:"name",angle:-45,textAnchor:"end",height:100,interval:0}),e.jsx(ce,{tickFormatter:n=>y==="revenue"?R(n):$(n)}),e.jsx(J,{formatter:(n,l)=>y==="revenue"?R(Number(n)):$(Number(n))}),e.jsx(Pe,{dataKey:y,fill:"#2563eb"})]})})]});case"categories":return e.jsx(_,{width:"100%",height:400,children:e.jsxs(Fe,{children:[e.jsx(Ve,{data:H,cx:"50%",cy:"50%",labelLine:!1,label:({name:n,percent:l})=>`${n} ${(l*100).toFixed(0)}%`,outerRadius:120,fill:"#8884d8",dataKey:"value",children:H.map((n,l)=>e.jsx(Be,{fill:L[l%L.length]},`cell-${l}`))}),e.jsx(J,{formatter:N})]})});default:return null}};return e.jsxs(D,{className:"bg-gradient-to-br from-white via-slate-50/30 to-white border-0 shadow-xl",children:[e.jsx(V,{className:"pb-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs(B,{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(X,{className:"w-5 h-5 text-blue-600"}),"Interactive Sales Charts"]})}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 flex items-center gap-1",children:[e.jsx(me,{className:"w-4 h-4"}),"Time Range:"]}),[{key:"1m",label:"Last Month"},{key:"3m",label:"Last 3 Months"},{key:"6m",label:"Last 6 Months"},{key:"1y",label:"Last Year"}].map(({key:n,label:l})=>e.jsx(Y,{variant:g===n?"default":"outline",size:"sm",onClick:()=>S(n),children:l},n))]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 flex items-center gap-1",children:[e.jsx(we,{className:"w-4 h-4"}),"Chart Type:"]}),e.jsxs(Y,{variant:b==="revenue"?"default":"outline",size:"sm",onClick:()=>a("revenue"),className:"flex items-center gap-1",children:[e.jsx(We,{className:"w-4 h-4"}),"Revenue Trend"]}),e.jsxs(Y,{variant:b==="products"?"default":"outline",size:"sm",onClick:()=>a("products"),className:"flex items-center gap-1",children:[e.jsx(X,{className:"w-4 h-4"}),"Top 10 Products"]}),e.jsxs(Y,{variant:b==="categories"?"default":"outline",size:"sm",onClick:()=>a("categories"),className:"flex items-center gap-1",children:[e.jsx(Ne,{className:"w-4 h-4"}),"Categories"]})]})]})}),e.jsx(M,{children:C()})]})},xs=({data:u})=>{const{metrics:g}=Ae(u),o=g.filter(i=>["Sales Revenue","Transactions","Unique Members"].includes(i.title)).map(i=>({location:i.title,label:i.description,value:i.value})),b=e.jsx(Xe,{salesData:u,defaultFileName:"sales-analytics-filtered",size:"sm",variant:"ghost"});return e.jsx(Qe,{title:"Sales Analytics",subtitle:"Comprehensive analysis of sales performance, revenue trends, and customer insights",variant:"sales",metrics:o,exportButton:b})},be=[{id:"all",name:"All Locations",fullName:"All Locations"},{id:"kwality",name:"Kwality House, Kemps Corner",fullName:"Kwality House, Kemps Corner"},{id:"supreme",name:"Supreme HQ, Bandra",fullName:"Supreme HQ, Bandra"},{id:"kenkere",name:"Kenkere House",fullName:"Kenkere House"}],Ns=({data:u})=>{const[g,o]=A.useState("all"),[b,i]=A.useState("classic"),[y,h]=A.useState(!1),[x,F]=A.useState(null),[I,H]=A.useState("metric"),[L,N]=A.useState(new Set),[S,a]=A.useState("revenue"),[s,C]=A.useState(()=>({dateRange:fe(),location:[],category:[],product:[],soldBy:[],paymentMethod:[]})),n=(r,d=!1)=>{var U,c,k;let j=[...r];if(g!=="all"&&(j=j.filter(T=>{var f;return g==="kwality"?T.calculatedLocation==="Kwality House, Kemps Corner":g==="supreme"?T.calculatedLocation==="Supreme HQ, Bandra":((f=T.calculatedLocation)==null?void 0:f.includes("Kenkere"))||T.calculatedLocation==="Kenkere House"})),!d&&(s.dateRange.start||s.dateRange.end)){const T=s.dateRange.start?new Date(s.dateRange.start):null,O=s.dateRange.end?(()=>{const f=new Date(s.dateRange.end);return f.setHours(23,59,59,999),f})():null;j=j.filter(f=>{if(!f.paymentDate)return!1;let q=null;const xe=f.paymentDate.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(xe){const[,te,G,Ie]=xe;q=new Date(parseInt(Ie),parseInt(G)-1,parseInt(te))}else{const te=[new Date(f.paymentDate),new Date(f.paymentDate.replace(/(\d{2})\/(\d{2})\/(\d{4})/,"$3-$2-$1")),new Date(f.paymentDate.replace(/(\d{2})\/(\d{2})\/(\d{4})/,"$2/$1/$3"))];for(const G of te)if(!isNaN(G.getTime())&&G.getFullYear()>1900&&G.getFullYear()<2100){q=G;break}}return!(!q||isNaN(q.getTime())||T&&q<T||O&&q>O)})}return(U=s.category)!=null&&U.length&&(j=j.filter(T=>s.category.some(O=>{var f;return(f=T.cleanedCategory)==null?void 0:f.toLowerCase().includes(O.toLowerCase())}))),(c=s.paymentMethod)!=null&&c.length&&(j=j.filter(T=>s.paymentMethod.some(O=>{var f;return(f=T.paymentMethod)==null?void 0:f.toLowerCase().includes(O.toLowerCase())}))),(k=s.soldBy)!=null&&k.length&&(j=j.filter(T=>s.soldBy.some(O=>{var f;return(f=T.soldBy)==null?void 0:f.toLowerCase().includes(O.toLowerCase())}))),s.minAmount&&(j=j.filter(T=>(T.paymentValue||0)>=s.minAmount)),s.maxAmount&&(j=j.filter(T=>(T.paymentValue||0)<=s.maxAmount)),j},l=A.useMemo(()=>n(u),[u,s,g]),v=A.useMemo(()=>n(u,!0),[u,g]),m=r=>{let d=l,j="product";r.rawData&&Array.isArray(r.rawData)&&r.rawData.length>0?d=r.rawData:Array.isArray(r)&&r.length>0?d=r:r.transactionData&&Array.isArray(r.transactionData)&&r.transactionData.length>0?d=r.transactionData:r.currentYearRawData&&r.lastYearRawData?d=[...r.currentYearRawData,...r.lastYearRawData]:d=l.filter(c=>{let k=!1;const T=[r.name,r.product,r.productName,r.paymentItem,r.cleanedProduct,r.membership,r.membershipType,r.item].filter(Boolean),O=[r.category,r.cleanedCategory,r.paymentCategory].filter(Boolean);for(const f of T)if(c.cleanedProduct===f||c.paymentItem===f||c.membershipType===f||c.paymentItem&&c.paymentItem.includes(f)||c.cleanedProduct&&c.cleanedProduct.includes(f)){k=!0;break}if(!k){for(const f of O)if(c.cleanedCategory===f||c.paymentCategory===f||c.cleanedCategory&&c.cleanedCategory.includes(f)){k=!0,j="category";break}}return r.soldBy&&c.soldBy===r.soldBy&&(k=!0,j="member"),r.paymentMethod&&c.paymentMethod===r.paymentMethod&&(k=!0,j="product"),k});const U=Q(W({},r),{rawData:d,filteredTransactionData:d,totalRevenue:d.reduce((c,k)=>c+(k.paymentValue||0),0),grossRevenue:d.reduce((c,k)=>c+(k.paymentValue||0),0),netRevenue:d.reduce((c,k)=>c+(k.paymentValue||0),0),totalValue:d.reduce((c,k)=>c+(k.paymentValue||0),0),totalCurrent:d.reduce((c,k)=>c+(k.paymentValue||0),0),metricValue:d.reduce((c,k)=>c+(k.paymentValue||0),0),transactions:d.length,totalTransactions:d.length,uniqueMembers:new Set(d.map(c=>c.memberId||c.customerEmail)).size,totalCustomers:new Set(d.map(c=>c.memberId||c.customerEmail)).size,specificRevenue:d.reduce((c,k)=>c+(k.paymentValue||0),0),specificTransactions:d.length,specificCustomers:new Set(d.map(c=>c.memberId||c.customerEmail)).size,specificProducts:new Set(d.map(c=>c.cleanedProduct||c.paymentItem)).size,isDynamic:!0,calculatedFromFiltered:!0});F(U),H(j)},t=r=>{const d=l,j=d.reduce((T,O)=>T+(O.paymentValue||0),0),U=d.length,c=new Set(d.map(T=>T.memberId||T.customerEmail)).size,k=Q(W({},r),{rawData:d,filteredTransactionData:d,totalRevenue:j,grossRevenue:j,netRevenue:j,totalValue:j,totalCurrent:j,metricValue:j,transactions:U,totalTransactions:U,uniqueMembers:c,totalCustomers:c,specificRevenue:j,specificTransactions:U,specificCustomers:c,isDynamic:!0,calculatedFromFiltered:!0});F(k),H("metric")},p=r=>{const d=new Set(L);d.has(r)?d.delete(r):d.add(r),N(d)},w=()=>{const r=fe();C({dateRange:r,location:[],category:[],product:[],soldBy:[],paymentMethod:[]})};return e.jsxs("div",{className:"space-y-8",children:[e.jsx(xs,{data:l}),e.jsx("div",{className:"container mx-auto px-6",children:e.jsx(Ze,{})}),e.jsx("div",{className:"container mx-auto px-6 space-y-6",children:e.jsxs(ne,{value:g,onValueChange:o,className:"w-full",children:[e.jsx("div",{className:"flex justify-center mb-8",children:e.jsx(le,{className:"bg-white/90 backdrop-blur-sm p-2 rounded-2xl shadow-xl border-0 grid grid-cols-4 w-full max-w-7xl min-h-24 overflow-hidden",children:be.map(r=>{var d;return e.jsx(z,{value:r.id,className:"relative px-6 py-4 font-semibold text-gray-800 transition-all duration-300 ease-out hover:scale-105 data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-lg hover:bg-gray-50 text-2xl rounded-2xl",children:e.jsxs("div",{className:"relative z-10 text-center",children:[e.jsx("div",{className:"font-bold",children:r.name.split(",")[0]}),e.jsx("div",{className:"text-xs opacity-80",children:(d=r.name.split(",")[1])==null?void 0:d.trim()})]})},r.id)})})}),be.map(r=>e.jsxs(E,{value:r.id,className:"space-y-8",children:[e.jsx("div",{className:"w-full",children:e.jsx(_e,{filters:s,onFiltersChange:C,onReset:w})}),e.jsx(ds,{data:l,onMetricClick:t}),e.jsx(ms,{data:v}),e.jsx(Je,{data:l}),e.jsxs(ne,{defaultValue:"monthOnMonth",className:"w-full",children:[e.jsxs(le,{className:"bg-white/90 backdrop-blur-sm p-2 rounded-2xl shadow-xl border-0 grid grid-cols-6 w-full max-w-6xl mx-auto overflow-hidden",children:[e.jsx(z,{value:"monthOnMonth",className:"relative rounded-xl px-4 py-3 font-semibold text-xs transition-all duration-300 ease-out hover:scale-105 data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-lg hover:bg-gray-50",children:"Month-on-Month"}),e.jsx(z,{value:"yearOnYear",className:"relative rounded-xl px-4 py-3 font-semibold text-xs transition-all duration-300 ease-out hover:scale-105 data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-lg hover:bg-gray-50",children:"Year-on-Year"}),e.jsx(z,{value:"productPerformance",className:"relative rounded-xl px-4 py-3 font-semibold text-xs transition-all duration-300 ease-out hover:scale-105 data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-lg hover:bg-gray-50",children:"Product Performance"}),e.jsx(z,{value:"categoryPerformance",className:"relative rounded-xl px-4 py-3 font-semibold text-xs transition-all duration-300 ease-out hover:scale-105 data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-lg hover:bg-gray-50",children:"Category Performance"}),e.jsx(z,{value:"soldByAnalysis",className:"relative rounded-xl px-4 py-3 font-semibold text-xs transition-all duration-300 ease-out hover:scale-105 data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-lg hover:bg-gray-50",children:"Sold By Analysis"}),e.jsx(z,{value:"paymentMethodAnalysis",className:"relative rounded-xl px-4 py-3 font-semibold text-xs transition-all duration-300 ease-out hover:scale-105 data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-lg hover:bg-gray-50",children:"Payment Methods"})]}),e.jsx(E,{value:"monthOnMonth",className:"mt-8",children:e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Month-on-Month Analysis"}),e.jsx(es,{data:v,onRowClick:m,collapsedGroups:L,onGroupToggle:p,selectedMetric:S})]})}),e.jsx(E,{value:"yearOnYear",className:"mt-8",children:e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Year-on-Year Analysis"}),e.jsx(ss,{data:v,onRowClick:m,selectedMetric:S})]})}),e.jsx(E,{value:"productPerformance",className:"mt-8",children:e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Product Performance Analysis"}),e.jsx(ls,{data:v,onRowClick:m,selectedMetric:S})]})}),e.jsx(E,{value:"categoryPerformance",className:"mt-8",children:e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Category Performance Analysis"}),e.jsx(is,{data:v,onRowClick:m,selectedMetric:S})]})}),e.jsx(E,{value:"soldByAnalysis",className:"mt-8",children:e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Sold By Analysis"}),e.jsx(ts,{data:v,onRowClick:m,selectedMetric:S})]})}),e.jsx(E,{value:"paymentMethodAnalysis",className:"mt-8",children:e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Payment Method Analysis"}),e.jsx(as,{data:v,onRowClick:m,selectedMetric:S})]})})]})]},r.id))]})}),x&&e.jsx(os,{isOpen:!!x,onClose:()=>F(null),data:x,type:I})]})};export{ys as S,Ns as a};
